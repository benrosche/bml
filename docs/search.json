[{"path":"https://benrosche.github.io/bml/articles/bml.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Getting Started with bml","text":"bml package implements Bayesian Multiple-Membership Multilevel Models Parameterizable Weight Functions. models designed situations higher-level outcomes depend combined influence multiple lower-level units. Instead aggregating lower-level data higher levels (risking aggregation bias) disaggregating outcomes lower levels (artificially inflating sample size), bml explicitly models lower-level units jointly shape higher-level outcomes.","code":""},{"path":"https://benrosche.github.io/bml/articles/bml.html","id":"installation","dir":"Articles","previous_headings":"","what":"Installation","title":"Getting Started with bml","text":"Install stable version CRAN: ’ll also need JAGS installed system. See installation vignette details.","code":"install.packages(\"bml\")"},{"path":"https://benrosche.github.io/bml/articles/bml.html","id":"basic-example","dir":"Articles","previous_headings":"","what":"Basic Example","title":"Getting Started with bml","text":"Let’s start simple example using coalition government data. coalition (higher-level unit) composed multiple political parties (lower-level units), want model party characteristics influence coalition outcomes.","code":"library(bml) data(coalgov)  # Examine the data structure head(coalgov[, c(\"gid\", \"pid\", \"pname\", \"n\", \"finance\", \"dur_wkb\", \"event_wkb\")])"},{"path":"https://benrosche.github.io/bml/articles/bml.html","id":"understanding-the-data-structure","dir":"Articles","previous_headings":"Basic Example","what":"Understanding the Data Structure","title":"Getting Started with bml","text":"coalgov dataset long format row represents party’s participation coalition: gid: Government (coalition) identifier pid: Party identifier n: Number parties coalition finance: Party’s financial dependence member contributions (standardized) dur_wkb: Coalition duration days event_wkb: Early termination indicator (1 = terminated early, 0 = censored)","code":""},{"path":"https://benrosche.github.io/bml/articles/bml.html","id":"model-1-basic-multiple-membership-model","dir":"Articles","previous_headings":"Basic Example","what":"Model 1: Basic Multiple-Membership Model","title":"Getting Started with bml","text":"first model examines coalition duration function party-level characteristics, aggregated using equal weights: Breaking formula: Surv(dur_wkb, event_wkb): Survival outcome (duration event indicator) majority: Government-level covariate (binary indicator) id = id(pid, gid): Party ID (member) government ID (group) vars = vars(finance): Party-level covariate aggregate fn = fn(w ~ 1/n, c = TRUE): Weight function (equal weights, constrained sum 1) RE = TRUE: Include party-specific random effects","code":"mod1 <- bml(   Surv(dur_wkb, event_wkb) ~ 1 + majority +     mm(       id = id(pid, gid),       vars = vars(finance),       fn = fn(w ~ 1/n, c = TRUE),       RE = TRUE     ),   family = \"Weibull\",   data = coalgov,   seed = 1 )  summary(mod1)"},{"path":"https://benrosche.github.io/bml/articles/bml.html","id":"model-2-parameterizing-the-weight-function","dir":"Articles","previous_headings":"Basic Example","what":"Model 2: Parameterizing the Weight Function","title":"Getting Started with bml","text":"key feature bml ability model aggregation weights function covariates. Instead assuming parties equal influence, can test whether seat share affects party’s weight coalition: New elements: weight function now includes pseat (party seat share) parameter b1 priors: Specify prior weight function parameter monitor = TRUE: Save MCMC chains diagnostics Interpretation: \\(b1 \\approx 0\\): Seat share doesn’t affect weights (equal influence) \\(b1 > 0\\): Larger parties weight \\(b1 < 0\\): Smaller parties weight","code":"mod2 <- bml(   Surv(dur_wkb, event_wkb) ~ 1 +     majority +     mm(       id = id(pid, gid),       vars = vars(finance),       fn = fn(w ~ 1 / (1 + (n - 1) * exp(-(b0 + b1 * pseat))), c = TRUE),       RE = TRUE     ),   family = \"Weibull\",   priors = c(\"b.w ~ dnorm(0,1)\"), # weakly informative prior on the weight parameters   data = coalgov,   seed = 1,   monitor = TRUE )  summary(mod2)"},{"path":"https://benrosche.github.io/bml/articles/bml.html","id":"visualizing-results","dir":"Articles","previous_headings":"Basic Example","what":"Visualizing Results","title":"Getting Started with bml","text":"","code":"# Diagnostic plot for weight parameter monetPlot(mod2, parameter = \"b.w.1[1]\", label = \"Seat share effect\")  # MCMC diagnostics mcmcDiag(mod2, parameters = \"b.w.1[1]\")"},{"path":"https://benrosche.github.io/bml/articles/bml.html","id":"next-steps","dir":"Articles","previous_headings":"","what":"Next Steps","title":"Getting Started with bml","text":"See Model documentation mathematical details Explore Examples spatial, network, aggregation applications Check FAQ common questions Read accompanying paper: Rosche (2026)","code":""},{"path":"https://benrosche.github.io/bml/articles/bml.html","id":"key-concepts","dir":"Articles","previous_headings":"","what":"Key Concepts","title":"Getting Started with bml","text":"Multiple-membership structure: Higher-level units (coalitions) contain multiple lower-level units (parties), lower-level units can appear multiple higher-level units. Fixed (e.g., equal weights w ~ 1/n) Endogenous (estimated data, e.g., w ~ 1/n^exp(b1*x)) c = TRUE: Weights sum 1 within group c = FALSE: constraint weight sums Random effects: Account unobserved heterogeneity member level (RE = TRUE mm()) nesting level (type = \"RE\" hm())","code":""},{"path":"https://benrosche.github.io/bml/articles/examples.html","id":"e1","dir":"Articles","previous_headings":"","what":"Example 1: Political Parties and the Survival of Coalition Governments","title":"Examples","text":"Coming soon…","code":""},{"path":"https://benrosche.github.io/bml/articles/examples.html","id":"e2","dir":"Articles","previous_headings":"","what":"Example 2: All Friends or Just Your Best Friend?","title":"Examples","text":"Coming soon…","code":""},{"path":"https://benrosche.github.io/bml/articles/examples.html","id":"e3","dir":"Articles","previous_headings":"","what":"Example 3: Air Quality and Home Values","title":"Examples","text":"Coming soon…","code":""},{"path":"https://benrosche.github.io/bml/articles/faq.html","id":"whats-the-difference-between-a-multiple-membership-model-and-a-conventional-multilevel-model","dir":"Articles","previous_headings":"","what":"1. What’s the difference between a multiple-membership model and a conventional multilevel model?","title":"Frequently Asked Questions","text":"conventional hierarchical multilevel model, lower-level unit belongs exactly one higher-level unit (e.g., students nested schools). multiple-membership model (MMMM), lower-level units can belong multiple higher-level units simultaneously, alternatively, higher-level outcomes can influenced multiple lower-level units. example: Conventional MLM: Students (level 1) nested schools (level 2) — student attends exactly one school. MMMM: Coalition governments (level 2) composed multiple political parties (level 1) — party can participate multiple governments time, government comprises multiple parties. MMMM accounts complex membership structure weighting contributions lower-level unit, allowing researchers model multiple units jointly shape higher-level outcomes.","code":""},{"path":"https://benrosche.github.io/bml/articles/faq.html","id":"whats-the-difference-between-a-conventional-mmmm-and-the-extended-mmmm-implemented-in-bml","dir":"Articles","previous_headings":"","what":"2. What’s the difference between a conventional MMMM and the extended MMMM implemented in bml?","title":"Frequently Asked Questions","text":"conventional MMMM (implemented MLwiN, brms, software) uses fixed, pre-specified weights aggregate lower-level effects. instance, might use equal weights (1/n) weights based time spent context. extended MMMM bml allows : Parameterize weight function: Instead fixing weights, can specify functional form weights (e.g., w ~ 1/n^exp(b*X)) estimate parameters determine lower-level units aggregated. Test alternative aggregation mechanisms: Compare different weighting schemes (equal weights, proportional weights, functions covariates) determine best fits data. Endogenize weight matrices: Rather imposing spatial network weights externally, let data determine connection strengths functions covariates. flexibility enables researchers explicitly model micro--macro link — lower-level characteristics aggregate produce higher-level outcomes.","code":""},{"path":"https://benrosche.github.io/bml/articles/faq.html","id":"when-should-i-use-bml-instead-of-other-multilevel-modeling-packages","dir":"Articles","previous_headings":"","what":"3. When should I use bml instead of other multilevel modeling packages?","title":"Frequently Asked Questions","text":"Use bml : multiple-membership structures: Higher-level outcomes depend multiple lower-level units (e.g., coalitions composed parties, teams composed individuals, neighborhoods influenced surrounding areas). need flexible weight functions: theory suggests weights depend covariates, group size, features, fixed advance. ’re studying aggregation processes / micro--macro relationships: research question focuses lower-level units jointly shape higher-level outcomes, rather higher-level contexts shape lower-level outcomes. Rather assuming fixed aggregation (e.g., simple average), want test estimate lower-level effects combine. standard hierarchical models without multiple membership, packages like lme4, brms, MCMCglmm efficient. conventional MMMMs fixed weights, brms MLwiN excellent alternatives.","code":""},{"path":"https://benrosche.github.io/bml/articles/faq.html","id":"what-outcome-types-and-distributions-does-bml-support","dir":"Articles","previous_headings":"","what":"4. What outcome types and distributions does bml support?","title":"Frequently Asked Questions","text":"bml supports variety outcome distributions commonly used social science research: Continuous outcomes: Gaussian (normal) regression Binary outcomes: Logit (logistic) regression Cox proportional hazards model Weibull accelerated failure time (AFT) model can also specify hierarchical random effects (hm() blocks) addition multiple-membership structures, allowing hierarchically nested cross-classified designs.","code":""},{"path":"https://benrosche.github.io/bml/articles/faq.html","id":"how-do-i-specify-the-weight-function-and-what-are-the-c-and-ar-parameters","dir":"Articles","previous_headings":"","what":"5. How do I specify the weight function, and what are the c and ar parameters?","title":"Frequently Asked Questions","text":"weight function specified fn() container within mm() block: Weight function components: Group size: n (number members group) Covariates: variable data Mathematical functions: exp(), log(), sqrt(), etc. Examples: w ~ 1/n (equal weights), w ~ tenure (proportional tenure), w ~ 1/n^exp(b*similarity) (similarity-weighted) c = TRUE (default): Weights normalized sum 1 within group (row-standardization) c = FALSE: Weights normalized (useful aggregating sums rather averages) ar = FALSE (default): Standard independent random effects member ar = TRUE: Member-level random effects evolve random walk across repeated group participations, capturing dynamics member’s unobserved heterogeneity changes time Important: one mm() block can RE = TRUE given model.","code":"mm(   id = id(member_id, group_id),   vars = vars(X),   fn = fn(w ~ 1/n, c = TRUE),   RE = TRUE,   ar = FALSE )"},{"path":"https://benrosche.github.io/bml/articles/faq.html","id":"how-do-i-fix-parameters-to-known-values","dir":"Articles","previous_headings":"","what":"6. How do I fix parameters to known values?","title":"Frequently Asked Questions","text":"two ways fix parameters bml, depending model appear.","code":""},{"path":"https://benrosche.github.io/bml/articles/faq.html","id":"main-equation-and-hm-blocks-using-fix","dir":"Articles","previous_headings":"6. How do I fix parameters to known values?","what":"Main equation and hm() blocks: Using fix()","title":"Frequently Asked Questions","text":"Use fix() helper inside vars() hold coefficient specified value rather estimating . works main equation hm() blocks. Main equation: equivalent adding exposure predictor constraining coefficient 1 instead estimating . useful offsets prior theory dictates specific coefficient value. hm() blocks: mm() blocks: , coefficient cohesion fixed 1 finance freely estimated.","code":"# Fix the coefficient of 'exposure' to 1 (i.e., use as an offset) m <- bml(   y ~ 1 + fix(exposure, 1) + x1 + x2,   family = \"Gaussian\",   data = dat ) m <- bml(   y ~ 1 + x1 +     mm(id = id(pid, gid), fn = fn(w ~ 1/n), RE = TRUE) +     hm(id = id(cid), vars = vars(fix(investiture, 0.5) + gdp), type = \"FE\"),   family = \"Gaussian\",   data   = coalgov ) m <- bml(   Surv(dur_wkb, event_wkb) ~ 1 + majority +     mm(       id   = id(pid, gid),       vars = vars(fix(cohesion, 1) + finance),       fn   = fn(w ~ 1/n, c = TRUE),       RE   = TRUE     ),   family = \"Weibull\",   data   = coalgov )"},{"path":"https://benrosche.github.io/bml/articles/faq.html","id":"weight-function-fn-omitting-parameters","dir":"Articles","previous_headings":"6. How do I fix parameters to known values?","what":"Weight function fn(): Omitting parameters","title":"Frequently Asked Questions","text":"weight function specified via fn(), fix weights simply including free parameters (b0, b1, …) formula. parameters appear, weight function treated known, fixed transformation. Compare weight functions include free parameters: key distinction: fn() formula contains b, b0, b1, etc., estimated. formula contains data variables constants (like n, pseat, 1), weights fixed.","code":"# Fixed equal weights (no parameters to estimate) fn(w ~ 1/n, c = TRUE)  # Fixed weights proportional to seat share (no parameters to estimate) fn(w ~ pseat, c = TRUE) # Estimable: b is estimated from data fn(w ~ 1/n^exp(b * x), c = TRUE)  # Estimable: b0 is estimated from data fn(w ~ 1 / (1 + (n - 1) * exp(-b0)), c = FALSE)"},{"path":"https://benrosche.github.io/bml/articles/faq.html","id":"i-get-error-in-node-w-1-invalid-parent-values-what-does-this-mean","dir":"Articles","previous_headings":"","what":"7. I get “Error in node w.1[…]: Invalid parent values” — what does this mean?","title":"Frequently Asked Questions","text":"error occurs JAGS evaluate weight function particular observation computed weight numerically invalid (e.g., NaN, Inf, value outside domain downstream function). commonly arises parameterized weight functions initialization phase. happens: Weight function parameters (b0, b1, …) given vague priors default (dnorm(0, 0.0001) JAGS precision, corresponds SD = 100). JAGS initializes MCMC chains, may draw extreme starting values (e.g., b0 = 80). weight functions involving nonlinear transformations like ilogit() exp(), extreme parameter values can cause numerical issues downstream — even weight function mathematically well-defined, resulting weights may produce overflow likelihood (e.g., exp(-mu * shape) Weibull model). Built-safeguard: bml initializes weight parameters 0 default. ensures numerically stable starting values (e.g., ilogit(0) = 0.5). However, error persists occurs sampling (just initialization), consider following steps. fix : Use informative priors. Narrow prior spread weight parameters sampler stays numerically stable region: especially important parameters inside ilogit(), exp(), functions saturate explode extreme inputs. Ensure weight function bounded. Unbounded weight functions can produce extreme values destabilize likelihood. Common strategies: Use ilogit() bound weights 0 1: fn(w ~ ilogit(b0 + b1 * x), c = TRUE) Use exp() carefully — grows rapidly, pair constraints like c = TRUE (normalization) wrap argument: fn(w ~ exp(b1 * x), c = TRUE) x standardized Standardize covariates weight function. weight variable large range (e.g., income thousands), product b1 * x can easily overflow. Standardize variables including fn(). Supply explicit initial values. default initialization 0 doesn’t work model, provide custom starting values: Re-run model. Since error can seed-dependent (different chains draw different initial values), simply re-running may resolve . However, indicates fragile parameterization — consider steps 1–3 robust solution.","code":"m <- bml(   ...,   priors = list(     \"b.w.1[1] ~ dnorm(0, 1)\",   # SD = 1 instead of 100     \"b.w.1[2] ~ dnorm(0, 1)\"   ) ) m <- bml(   ...,   inits = list(\"b.w.1\" = c(0.5, -0.1)) )"},{"path":"https://benrosche.github.io/bml/articles/installation.html","id":"install-jags","dir":"Articles","previous_headings":"","what":"1. Install JAGS","title":"Installation","text":"Install latest JAGS version operating system : https://mcmc-jags.sourceforge.io/ installing JAGS, restart R rjags can find .","code":""},{"path":[]},{"path":"https://benrosche.github.io/bml/articles/installation.html","id":"option-a-install-from-cran-recommended","dir":"Articles","previous_headings":"2. Install bml R package","what":"Option A: Install from CRAN (Recommended)","title":"Installation","text":"stable release version available CRAN:","code":"install.packages(\"bml\")"},{"path":"https://benrosche.github.io/bml/articles/installation.html","id":"option-b-install-development-version-from-github","dir":"Articles","previous_headings":"2. Install bml R package","what":"Option B: Install development version from GitHub","title":"Installation","text":"latest development features, install GitHub using remotes: want build vignettes locally installation:","code":"install.packages(\"remotes\") remotes::install_github(\"benrosche/bml\") remotes::install_github(\"benrosche/bml\", build_vignettes = TRUE)"},{"path":"https://benrosche.github.io/bml/articles/installation.html","id":"troubleshooting","dir":"Articles","previous_headings":"","what":"Troubleshooting","title":"Installation","text":"Error: (converted warning) ... installing. remotes treats installation warning error machine. can opt : JAGS found / rjags fails load: Make sure JAGS installed (just R packages), restart R. Windows, confirm installed 64-bit JAGS build using 64-bit R.","code":"Sys.setenv(R_REMOTES_NO_ERRORS_FROM_WARNINGS = \"true\") remotes::install_github(\"benrosche/bml\")"},{"path":"https://benrosche.github.io/bml/articles/model.html","id":"overview","dir":"Articles","previous_headings":"","what":"Overview","title":"Model Structure","text":"bml package implements Bayesian multiple-membership multilevel models (MMMM) parameterizable weight functions. models designed data structures : Lower-level units (members) can belong multiple higher-level units (groups) Groups composed multiple members Group outcomes depend combined influence constituent members structure common across many empirical settings: political parties participating multiple coalition governments, individuals participating multiple teams, spatial units influenced multiple neighbors, students peer networks, student influenced multiple peers. key innovation extended MMMM allows researchers model rather impose aggregation mechanism member-level effects combine influence group-level outcomes.","code":""},{"path":"https://benrosche.github.io/bml/articles/model.html","id":"notation-and-data-structure","dir":"Articles","previous_headings":"","what":"Notation and Data Structure","title":"Model Structure","text":"Let: \\(= 1, \\ldots, N\\) index groups (primary unit analysis) \\(k = 1, \\ldots, K\\) index members (lower-level units) \\(j = 1, \\ldots, J\\) index nesting units (higher-level contexts) \\(p[]\\) denote set members belonging group \\(\\) \\(n_i = |p[]|\\) denote number members group \\(\\) Example (Coalition Governments): Groups governments (\\(\\)), members political parties (\\(k\\)), nesting units countries (\\(j\\)). function \\(p[]\\) returns parties government \\(\\), \\(n_i\\) coalition size. outcome \\(y_i^{(g)}\\) measured group level, superscript \\((g)\\) denotes level measurement. follows, present model Gaussian (normal) outcomes, though framework extends distributions (see ).","code":""},{"path":[]},{"path":"https://benrosche.github.io/bml/articles/model.html","id":"full-model-specification","dir":"Articles","previous_headings":"The Extended Multiple-Membership Multilevel Model","what":"Full Model Specification","title":"Model Structure","text":"extended MMMM decomposes group-level outcome three additive components, corresponding level explanatory factors operate: \\[\\begin{equation} y_i^{(g)} = \\theta_i^{(g)} + \\theta_{j[]}^{(c)} + \\theta_i^{(p)} \\tag{1} \\end{equation}\\] : \\(\\theta_i^{(g)}\\) denotes group-level effect associated government \\(\\). \\(\\theta_{j[]}^{(c)}\\) denotes hierarchical nesting-level effect associated country \\(j[]\\). \\(\\theta_i^{(p)}\\) denotes aggregated member-level effect, summarizing party-level contributions within government \\(\\). component includes systematic effects (observed covariates) random effects (unobserved heterogeneity).","code":""},{"path":"https://benrosche.github.io/bml/articles/model.html","id":"group-level-effect","dir":"Articles","previous_headings":"The Extended Multiple-Membership Multilevel Model","what":"Group-Level Effect","title":"Model Structure","text":"group-level effect models direct influence group-level covariates group-specific unobserved factors: \\[\\begin{equation} \\theta_i^{(g)} = \\mathbf{\\beta}^{(g)} \\cdot \\mathbf{x}_i^{(g)} + u_i^{(g)}, \\quad u_i^{(g)} \\overset{\\text{iid}}{\\sim} N(0, \\sigma_{u^{(g)}}^2) \\tag{2} \\end{equation}\\] : \\(\\mathbf{x}_i^{(g)} = [1, x_{1i}^{(g)}, \\ldots, x_{Gi}^{(g)}]\\) vector group-level covariates \\(\\mathbf{\\beta}^{(g)} = [\\beta_0^{(g)}, \\beta_1^{(g)}, \\ldots, \\beta_G^{(g)}]\\) corresponding regression coefficients \\(u_i^{(g)}\\) independently identically distributed (..d.) random effects \\(\\sigma_{u^{(g)}}^2\\) captures unobserved heterogeneity group level Example: government survival, \\(\\mathbf{x}_i^{(g)}\\) might include majority status, ideological heterogeneity, economic conditions.","code":""},{"path":"https://benrosche.github.io/bml/articles/model.html","id":"hierarchical-nesting-level-effect","dir":"Articles","previous_headings":"The Extended Multiple-Membership Multilevel Model","what":"Hierarchical Nesting-Level Effect","title":"Model Structure","text":"groups nested within higher-level contexts, nesting-level effect accounts hierarchical dependencies: \\[\\begin{equation} \\theta_j^{(c)} = \\mathbf{\\beta}^{(c)} \\cdot \\mathbf{x}_j^{(c)} + u_j^{(c)}, \\quad u_j^{(c)} \\overset{\\text{iid}}{\\sim} N(0, \\sigma_{u^{(c)}}^2) \\tag{3} \\end{equation}\\] : \\(\\mathbf{x}_j^{(c)} = [x_{1j}^{(c)}, \\ldots, x_{Cj}^{(c)}]\\) nesting-level covariates \\(\\mathbf{\\beta}^{(c)} = [\\beta_1^{(c)}, \\ldots, \\beta_C^{(c)}]\\) corresponding coefficients \\(u_j^{(c)}\\) ..d. random effects \\(\\sigma_{u^{(c)}}^2\\) captures unobserved heterogeneity nesting level Including \\(u_j^{(c)}\\) allows groups within nesting unit similar groups across nesting units, even conditioning observed covariates. Example: Governments nested within countries. Country-level variables might include electoral system investiture requirements. random effect captures country-specific factors affecting governments country. Note: Multiple hm() blocks can specified accommodate cross-classified structures (e.g., groups nested within multiple hierarchical contexts).","code":""},{"path":"https://benrosche.github.io/bml/articles/model.html","id":"aggregated-member-level-effect","dir":"Articles","previous_headings":"The Extended Multiple-Membership Multilevel Model","what":"Aggregated Member-Level Effect","title":"Model Structure","text":"core innovation extended MMMM modeling member-level effects aggregate influence group outcomes. Individual member effects first specified, aggregated via weighted sum: \\[\\begin{equation} \\theta_i^{(p)} = \\sum_{k \\p[]} w_{ik} \\left( \\mathbf{\\beta}^{(p)} \\cdot \\mathbf{x}_{ik}^{(p)} + u_k^{(p)} \\right) \\tag{4} \\end{equation}\\] can decomposed systematic random components: \\[\\begin{equation} \\theta_i^{(p)} = \\underbrace{\\mathbf{\\beta}^{(p)} \\sum_{k \\p[]} w_{ik} \\mathbf{x}_{ik}^{(p)}}_{\\text{Systematic component}} + \\underbrace{\\sum_{k \\p[]} w_{ik} u_k^{(p)}}_{\\text{Random  component}}, \\quad u_k^{(p)} \\overset{\\text{iid}}{\\sim} N(0, \\sigma_{u^{(p)}}^2) \\tag{5} \\end{equation}\\] : \\(\\mathbf{x}_{ik}^{(p)} = [x_{1ik}^{(p)}, \\ldots, x_{Pik}^{(p)}]\\) member-level covariates \\(\\mathbf{\\beta}^{(p)} = [\\beta_1^{(p)}, \\ldots, \\beta_P^{(p)}]\\) structural regression coefficients measuring effect member attributes group outcomes \\(w_{ik}\\) aggregation weights determining member \\(k\\)’s contribution enters group \\(\\)’s outcome \\(u_k^{(p)}\\) ..d. member-specific random effects \\(\\sigma_{u^{(p)}}^2\\) captures unobserved heterogeneity member level Interpretation Weights: weights \\(w_{ik}\\) define micro-macro link — individual member characteristics combine produce group-level attributes. Since structural effect \\(\\mathbf{\\beta}^{(p)}\\) constant, weights serve aggregate member-level covariate \\(\\mathbf{x}_{ik}^{(p)}\\) group-level construct \\(\\sum_{k \\p[]} w_{ik} \\mathbf{x}_{ik}^{(p)}\\). Covariance Structure: Including member-specific random effects \\(u_k^{(p)}\\) induces covariance among groups sharing members. covariance groups \\(\\) \\('\\) : \\[\\begin{equation} \\text{Cov}(y_i^{(g)}, y_{'}^{(g)}) = \\sigma_{u^{(p)}}^2 \\sum_k w_{ik} w_{'k} \\tag{6} \\end{equation}\\] increases degree member overlap accounts dependencies across groups involving recurring members. Example: coalition governments, \\(\\mathbf{x}_{ik}^{(p)}\\) might include party cohesion organizational structure. random effect \\(u_k^{(p)}\\) captures party-specific unobserved factors affect governments party \\(k\\) participates.","code":""},{"path":[]},{"path":"https://benrosche.github.io/bml/articles/model.html","id":"conventional-mmmm-fixed-weights","dir":"Articles","previous_headings":"Parameterizable Weight Functions","what":"Conventional MMMM: Fixed Weights","title":"Model Structure","text":"conventional MMMM requires weights specified priori. common choice equal weighting (arithmetic mean): \\[\\begin{equation} w_{ik} = \\frac{1}{n_i} \\tag{7} \\end{equation}\\] assumes members contribute equally group outcomes, regardless attributes context. Limitations: Equal weighting can theoretically implausible. coalition governments, instance, larger parties, parties holding prime ministership, ideologically central parties may exert disproportionate influence. spatial analysis, nearby neighbors may matter distant ones. Imposing equal weights vary practice introduces aggregation bias.","code":""},{"path":"https://benrosche.github.io/bml/articles/model.html","id":"extended-mmmm-parameterizing-weights","dir":"Articles","previous_headings":"Parameterizable Weight Functions","what":"Extended MMMM: Parameterizing Weights","title":"Model Structure","text":"extended MMMM allows weights modeled functions covariates estimated parameters. example, \\[\\begin{equation} w_{ik}(\\mathbf{x}_{ik}^{(w)}, n_i) = \\frac{1}{1 + (n_i - 1) \\exp\\left(-\\mathbf{\\beta}^{(w)} \\cdot \\mathbf{x}_{ik}^{(w)}\\right)} \\tag{8} \\end{equation}\\] subject normalization constraint \\(\\sum_{k \\p[]} w_{ik} = 1\\) \\(\\). bml, specified via: : \\(\\mathbf{x}_{ik}^{(w)} = [1, x_{1ik}^{(w)}, \\ldots, x_{Wik}^{(w)}]\\) weight covariates \\(\\mathbf{\\beta}^{(w)} = [\\beta_0^{(w)}, \\beta_1^{(w)}, \\ldots, \\beta_W^{(w)}]\\) weight function parameters estimated Functional Form: Equation (8) generalizes logistic function centering \\(1/n_i\\) \\(\\mathbf{\\beta}^{(w)} \\cdot \\mathbf{x}_{ik}^{(w)} = 0\\). sets equal weighting baseline: absent systematic differences, member receives weight \\(1/n_i\\). \\(\\mathbf{\\beta}^{(w)} \\neq 0\\), weights deviate baseline, reflecting heterogeneous member influence. Properties: Bounded: \\(w_{ik} \\[0, 1]\\) Baseline-centered: \\(\\mathbf{\\beta}^{(w)} = 0\\), weights reduce \\(w_{ik} = 1/n_i\\) Monotonic: Weights increase/decrease smoothly linear predictor Normalized: Constraint ensures \\(\\sum_k w_{ik} = 1\\) (unless normalization desired) Interpretation Weight Parameters: \\(\\mathbf{\\beta}^{(p)}\\) measure structural effects member attributes group outcomes, \\(\\mathbf{\\beta}^{(w)}\\) measure aggregation effects—member attributes determine relative importance weighted sum. Together, reveal matters (structural effects) much different members’ characteristics matter (aggregation effects). Example: Let \\(x_{ik}^{(p)}\\) = party cohesion \\(x_{ik}^{(w)}\\) = indicator holding prime ministership government survival model. \\(\\beta^{(w)} = 0\\): Prime minister’s cohesion matters much coalition partners’ cohesion (equal weights) \\(\\beta^{(w)} > 0\\): Prime minister’s cohesion carries weight \\(\\beta^{(w)} < 0\\): Coalition partners’ cohesion carries weight","code":"fn(w ~ 1 / (1 + (n - 1) * exp(-(b0 + b1 * x1 + b2 * x2))))"},{"path":"https://benrosche.github.io/bml/articles/model.html","id":"testing-alternative-aggregation-mechanisms","dir":"Articles","previous_headings":"Parameterizable Weight Functions","what":"Testing Alternative Aggregation Mechanisms","title":"Model Structure","text":"Weight function regression enables empirical tests substantive hypotheses aggregation. Group-level functions min(), max(), mean(), sum() can incorporated directly weight formulas, standard mathematical transformations supported. example: 1. Mean vs. Extremes: group outcome depend average member attribute extreme values (minimum/maximum)? \\[w_{ik} = \\beta_1^{(w)} \\cdot x_{ik}^{(w)} + (1 - \\beta_1^{(w)}) \\cdot \\mathbb{1}\\left[x_{ik}^{(w)} = \\min_k x_{ik}^{(w)}\\right]\\] bml: parameter \\(\\beta_1^{(w)}\\) controls mixture aggregation mechanisms. \\(\\beta_1^{(w)} = 1\\), weights proportional \\(x_{ik}^{(w)}\\) (mean-like aggregation); \\(\\beta_1^{(w)} = 0\\), weight assigned member minimum value. Intermediate values yield convex combination . Replacing min() max() tests whether highest-valued member dominates. preserve interpretation, \\(\\beta_1^{(w)}\\) constrained \\([0,1]\\), e.g., via priors = list(“b1~dunif(0,1)”). 2. Mean vs. Sum: member effects contextual (mean aggregation: \\(\\sum_k w_{ik} = 1\\)) autonomous (sum aggregation: \\(\\sum_k w_{ik} = n_i\\))? \\[w_{ik} = \\frac{1}{1 + (n_i - 1) \\exp\\left(-\\beta_0^{(w)}\\right)}\\] bml: \\(\\beta_0^{(w)} \\approx 0\\), weight evaluates \\(1/n_i\\), yielding mean aggregation (\\(\\sum_k w_{ik} = 1\\)). \\(\\beta_0^{(w)}\\) grows large, weight approaches 1 member, yielding sum aggregation (\\(\\sum_k w_{ik} = n_i\\)). mean aggregation, one-unit change \\(x_{ik}^{(p)}\\) affects outcome \\(\\beta^{(p)}\\) members change. sum aggregation, one-unit change single member already produces effect \\(\\beta^{(p)}\\). 3. Asymmetric Influence: certain members (e.g., larger, central, powerful) carry disproportionate weight? \\[ w_{ik} = \\frac{1}{1 + (n_i - 1) \\exp\\left(-(\\beta_0^{(w)} + \\beta_1^{(w)} x_{1ik}^{(w)} + \\beta_2^{(w)} x_{2ik}^{(w)})\\right)} \\] bml: weight function tests whether member attributes \\(x_1, x_2\\) (e.g., size, organization, power) generate disproportionate influence via \\(\\beta_1^{(w)}, \\beta_2^{(w)}\\).","code":"fn(   w ~ b1 * x + (1 - b1) * (x == min(x)),   c = TRUE ) fn(   w ~ 1 / (1 + (n - 1) * exp(-b0)),   c = FALSE ) fn(   w ~ 1 / (1 + (n - 1) * exp(-(b0 + b1 * x1 + b2 * x2))),   c = TRUE )"},{"path":"https://benrosche.github.io/bml/articles/model.html","id":"generalized-outcomes","dir":"Articles","previous_headings":"","what":"Generalized Outcomes","title":"Model Structure","text":"model structure extends non-Gaussian outcomes via generalized linear survival models: Binomial (Logistic Regression): \\[\\begin{equation} \\text{logit}\\left(P(y_i^{(g)} = 1)\\right) = \\theta_i^{(g)} + \\theta_{j[]}^{(c)} + \\theta_i^{(p)} \\tag{9} \\end{equation}\\] bml, specify family = \"Binomial\": Weibull Survival Model: \\[\\begin{equation} \\log(t_i) = \\theta_i^{(g)} + \\theta_{j[]}^{(c)} + \\theta_i^{(p)} + \\sigma \\epsilon_i \\tag{10} \\end{equation}\\] \\(t_i\\) survival time, \\(\\epsilon_i\\) follows extreme value distribution, \\(\\sigma\\) scale parameter related Weibull shape parameter. bml, specify family = \"Weibull\" Surv() outcome: Cox Proportional Hazards Model: \\[\\begin{equation} h(t_i) = h_0(t) \\exp\\left(\\theta_i^{(g)} + \\theta_{j[]}^{(c)} + \\theta_i^{(p)}\\right) \\tag{11} \\end{equation}\\] \\(h_0(t)\\) baseline hazard function, estimated non-parametrically piecewise constant function. bml, specify family = \"Cox\". optional cox_intervals argument controls number intervals piecewise constant baseline hazard: outcome types support full multilevel multiple-membership structure, including parameterizable weight functions.","code":"bml(y ~ 1 + x1 + mm(...) + hm(...), family = \"Binomial\", data = d) bml(Surv(time, event) ~ 1 + x1 + mm(...) + hm(...), family = \"Weibull\", data = d) bml(Surv(time, event) ~ 1 + x1 + mm(...) + hm(...), family = \"Cox\", cox_intervals = 10, data = d)"},{"path":"https://benrosche.github.io/bml/articles/model.html","id":"variance-decomposition-and-intraclass-correlation","dir":"Articles","previous_headings":"","what":"Variance Decomposition and Intraclass Correlation","title":"Model Structure","text":"multilevel structure partitions total variance additive components corresponding level model. three-level model group, nesting, member levels: \\[\\begin{equation} \\text{Var}(y_i^{(g)}) = \\sigma_{u^{(g)}}^2 + \\sigma_{u^{(c)}}^2 + \\sigma_{u^{(p)}}^2 \\sum_{k \\p[]} w_{ik}^2 \\tag{12} \\end{equation}\\] Note member-level variance component scaled sum squared weights. equal weights (\\(w_{ik} = 1/n_i\\)), simplifies \\(\\sigma_{u^{(p)}}^2 / n_i\\), effective member-level variance shrinks group size increases. unequal weights, members larger weights contribute variance.","code":""},{"path":"https://benrosche.github.io/bml/articles/model.html","id":"intraclass-correlation-coefficients-icc","dir":"Articles","previous_headings":"Variance Decomposition and Intraclass Correlation","what":"Intraclass Correlation Coefficients (ICC)","title":"Model Structure","text":"intraclass correlation coefficient (ICC) given level proportion total variance attributable level. Intuitively, ICC answers: “fraction total variation outcome due differences units level?” example, ICC 0.30 country level means 30% outcome variation can attributed -country differences, remaining 70% arises variation levels (e.g., groups within countries, members). \\[\\begin{align} \\rho^{(g)} &= \\frac{\\sigma_{u^{(g)}}^2}{\\sigma_{u^{(g)}}^2 + \\sigma_{u^{(c)}}^2 + \\sigma_{u^{(p)}}^2 \\overline{w^2}} \\tag{13} \\\\ \\rho^{(c)} &= \\frac{\\sigma_{u^{(c)}}^2}{\\sigma_{u^{(g)}}^2 + \\sigma_{u^{(c)}}^2 + \\sigma_{u^{(p)}}^2 \\overline{w^2}} \\tag{14} \\\\ \\rho^{(p)} &= \\frac{\\sigma_{u^{(p)}}^2 \\overline{w^2}}{\\sigma_{u^{(g)}}^2 + \\sigma_{u^{(c)}}^2 + \\sigma_{u^{(p)}}^2 \\overline{w^2}} \\tag{15} \\end{align}\\] \\(\\overline{w^2} = \\frac{1}{N} \\sum_{=1}^{N} \\sum_{k \\p[]} w_{ik}^2\\) average sum squared weights across groups. Since model estimated via MCMC, ICCs inherit full posterior distributions. varDecomp() function computes ICCs per posterior draw summarizes , properly propagating uncertainty: uncertainty argument controls reported uncertainty measure: \"sd\" (posterior standard deviation, default), \"mad\" (median absolute deviation), \"ci\" (95% credible intervals). Family-specific handling: Binomial models, residual \\(\\sigma\\), latent logistic residual variance \\(\\pi^2/3 \\approx 3.29\\) used. Cox models, also lack residual variance, ICCs computed among non-residual components .","code":"m1 <- bml(   Surv(dur_wkb, event_wkb) ~ 1 + majority +     mm(id = id(pid, gid), vars = vars(cohesion), fn = fn(w ~ 1/n), RE = TRUE) +     hm(id = id(cid), type = \"RE\"),   family = \"Weibull\",   data = coalgov )  varDecomp(m1) varDecomp(m1, uncertainty = \"ci\")"},{"path":[]},{"path":"https://benrosche.github.io/bml/articles/model.html","id":"multiple-mm-blocks","dir":"Articles","previous_headings":"Extensions","what":"Multiple MM Blocks","title":"Model Structure","text":"bml package allows multiple mm() blocks distinct aggregation mechanisms. useful different member-level covariates aggregate different processes: \\[\\begin{equation} \\theta_i^{(p)} = \\sum_{b=1}^B \\sum_{k \\p[]} w_{ik}^{(b)} \\left( \\mathbf{\\beta}^{(p,b)} \\cdot \\mathbf{x}_{ik}^{(p,b)} + u_k^{(p,b)} \\right) \\tag{16} \\end{equation}\\] \\(b\\) indexes MM blocks, weight function \\(w_{ik}^{(b)} = f(\\mathbf{x}_{ik}^{(w,b)}, n_i)\\). Example: Model effect cohesion party largest seat share party random effects specified equal weights: Important: given id(pid, gid) combination, one mm() block may include RE = TRUE within model.","code":"mm(id = id(pid, gid), vars = vars(cohesion), fn = fn(w ~ pseat == max(pseat)), RE = FALSE) + mm(id = id(pid, gid), vars = NULL, fn = fn(w ~ 1/n), RE = TRUE)"},{"path":"https://benrosche.github.io/bml/articles/model.html","id":"autoregressive-random-effects","dir":"Articles","previous_headings":"Extensions","what":"Autoregressive Random Effects","title":"Model Structure","text":"Member random effects may evolve time rather remain constant. ar = TRUE option specifies random walk process: \\[\\begin{equation} u_{ik}^{(p)} \\sim \\begin{cases} N(0, \\sigma_{u^{(p)}}^2) & \\text{} g[,k] = \\emptyset \\\\ N(u_{g[,k],k}^{(p)}, \\sigma_{u^{(p)}}^2) & \\text{} g[,k] \\neq \\emptyset \\end{cases} \\tag{17} \\end{equation}\\] \\(g[,k]\\) returns recent previous group member \\(k\\) participated. \\(g[,k] = \\emptyset\\) (first participation), effect drawn prior. Interpretation: Autoregressive effects capture dynamics member’s unobserved heterogeneity changes across successive group participations. variance \\(\\sigma_{u^{(p)}}^2\\) now represents innovation variance governing temporal change. Example: party’s propensity destabilize governments may evolve leadership, organization, electoral fortunes change. Usage:","code":"mm(id = id(pid, gid), vars = vars(cohesion), fn = fn(w ~ 1/n), RE = TRUE, ar = TRUE)"},{"path":"https://benrosche.github.io/bml/articles/model.html","id":"opposition-members","dir":"Articles","previous_headings":"Extensions","what":"Opposition Members","title":"Model Structure","text":"analyzing group outcomes influenced members non-members (e.g., coalition opposition parties), separate mm() blocks can model distinct contributions: \\[\\begin{equation} \\theta_i^{(p)} = \\sum_{k \\p[]} w_{ik}^{(g)} \\left( \\mathbf{\\beta}^{(g)} \\cdot \\mathbf{x}_{ik}^{(g)} + u_k^{(g)} \\right) + \\sum_{k \\notin p[]} w_{ik}^{(o)} \\left( \\mathbf{\\beta}^{(o)} \\cdot \\mathbf{x}_{ik}^{(o)} + u_k^{(o)} \\right) \\tag{18} \\end{equation}\\] superscripts \\((g)\\) \\((o)\\) denote member non-member effects, respectively. allows groups different structural effects different aggregation mechanisms. bml, specified using two mm() blocks different mmid variables — one members (\\(k \\p[]\\)) one non-members (\\(k \\notin p[]\\)): Data format: Since two mm() blocks use different member ID variables (pid_g pid_o), data stacked long format member gets row, NA mmid column belong : Government parties pid_g filled pid_o = NA; opposition parties pid_o filled pid_g = NA. Group-level variables (e.g., dur_wkb, event_wkb) repeated across rows within group, standard long format.","code":"mm(id = id(pid_g, gid), vars = vars(x1, x2), fn = fn(w ~ 1/n), RE = TRUE) + mm(id = id(pid_o, gid), vars = vars(x1, x2), fn = fn(w ~ 1/n), RE = TRUE) gid  pid_g  pid_o  x1    x2    dur_wkb  event_wkb 1    1      NA     0.5   0.3   365      0 1    2      NA     0.4   0.2   365      0 1    NA     3      0.3   0.1   365      0 1    NA     4      0.7   0.5   365      0"},{"path":"https://benrosche.github.io/bml/articles/model.html","id":"comparison-with-conventional-mmmm","dir":"Articles","previous_headings":"","what":"Comparison with Conventional MMMM","title":"Model Structure","text":"conventional MMMM (implemented brms MLwiN) special case: \\[\\begin{equation} y_i^{(g)} = \\mathbf{\\beta}^{(g)} \\cdot \\mathbf{x}_i^{(g)} + \\mathbf{\\beta}^{(p)} \\cdot \\bar{\\mathbf{x}}_{}^{(p)} + \\sum_{k \\p[]} w_{ik} u_k^{(p)} + u_i^{(g)} \\end{equation}\\] \\(\\bar{\\mathbf{x}}_{}^{(p)} = \\sum_k w_{ik} \\mathbf{x}_{ik}^{(p)}\\) pre-aggregated using imposed weights \\(w_{ik}\\). extended MMMM generalizes : Aggregating systematic random components within model Endogenizing weights functions covariates estimable parameters Enabling multiple aggregation mechanisms via multiple mm() blocks \\[\\begin{equation} y_i^{(g)} = \\mathbf{\\beta}^{(g)} \\cdot \\mathbf{x}_i^{(g)} + \\sum_{k \\p[]} w_{ik} \\left( \\mathbf{\\beta}^{(p)} \\cdot \\mathbf{x}_{ik}^{(p)} + u_k^{(p)} \\right) + u_i^{(g)}, \\quad w_{ik} = f(\\mathbf{x}_{ik}^{(w)}, n_i) \\end{equation}\\]","code":""},{"path":"https://benrosche.github.io/bml/articles/model.html","id":"model-assumptions","dir":"Articles","previous_headings":"","what":"Model Assumptions","title":"Model Structure","text":"extended MMMM assumes: Independence random components across levels: \\(u_i^{(g)} \\perp u_j^{(c)} \\perp u_k^{(p)}\\). violated, variance estimates may biased. complex covariance structures can accommodated needed. Random effects uncorrelated covariates (random effects assumption). However, including within-cluster means covariates using within-specifications isolates within-cluster effects, yielding identical point estimates fixed effect models. Correct functional form weight function. logistic-type function Equation (8) flexible, forms can specified using fn() syntax. Proper model specification: Misspecifying weight covariate structural covariate (vice versa) yields null effects misspecified variable correctly identifying properly specified ones, provided omitted variable bias.","code":""},{"path":"https://benrosche.github.io/bml/articles/model.html","id":"estimation","dir":"Articles","previous_headings":"","what":"Estimation","title":"Model Structure","text":"Model parameters estimated using Bayesian Markov chain Monte Carlo (MCMC) via JAGS : likelihood closed-form solution due parameterized weight function Bayesian estimation captures uncertainty variance estimates, yielding credible intervals even maximum likelihood methods report zero variance Weakly informative priors can specified parameters regularize estimates small samples bml package provides user-friendly interface JAGS automated prior specification, convergence diagnostics, post-estimation tools.","code":""},{"path":"https://benrosche.github.io/bml/articles/model.html","id":"further-information","dir":"Articles","previous_headings":"","what":"Further Information","title":"Model Structure","text":"comprehensive presentation model provided Rosche (2026).","code":""},{"path":"https://benrosche.github.io/bml/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Benjamin Rosche. Author, maintainer.","code":""},{"path":"https://benrosche.github.io/bml/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Rosche B (2026). bml: Bayesian Multiple-Membership Multilevel Models Parameterizable Weight Functions. R package version 0.9.0, https://benrosche.github.io/bml/.","code":"@Manual{,   title = {bml: Bayesian Multiple-Membership Multilevel Models with Parameterizable Weight Functions},   author = {Benjamin Rosche},   year = {2026},   note = {R package version 0.9.0},   url = {https://benrosche.github.io/bml/}, }"},{"path":"https://benrosche.github.io/bml/index.html","id":"bml-bayesian-multiple-membership-multilevel-models-with-parameterizable-weight-functions","dir":"","previous_headings":"","what":"bml: Bayesian Multiple-Membership Multilevel Models with Parameterizable Weight Functions","title":"bml","text":"bml R package fitting Bayesian Multiple-Membership Multilevel Models Parameterizable Weight Functions (“extended MMMM”) via JAGS. supports range outcome types—including linear, logit, survival models (Cox Weibull)—designed settings researchers want model multiple units lower level jointly influence outcomes higher level. multilevel analyses, primary focus higher-level contextual units (e.g., neighborhoods, schools, countries) shape outcomes observed lower levels (e.g., individuals, students, governments), reflecting macro--micro perspective. bml turns logic around. extended multiple-membership multilevel model, allows researchers explicitly model combined influence many lower-level units propagates “upwards” higher-level outcome, enabling study micro--macro relationships. Traditional approaches micro-macro questions either () aggregate lower-level variables higher level (risking aggregation bias), (ii) disaggregate higher-level outcomes lower level (artificially inflating sample size). strategies obscure underlying aggregation process, ignore statistical dependencies present data, prevent decomposition variance across levels. contrast, extended MMMM implemented bml explicitly models aggregation weight function may depend parameters covariates. approach provides theoretically grounded statistically principled framework studying micro-macro relationships using regression models.","code":""},{"path":"https://benrosche.github.io/bml/index.html","id":"with-the-bml-package-you-can","dir":"","previous_headings":"bml: Bayesian Multiple-Membership Multilevel Models with Parameterizable Weight Functions","what":"With the bml package, you can","title":"bml","text":"Model lower-level units jointly shape higher-level outcomes: example, political parties shape coalition outcomes, family members influence household decisions, subunits jointly shape organizational performance. Compare estimate aggregation functions: Test whether higher-level outcomes depend mean, sum, minimum, maximum, functions lower-level features, instead imposing predefined aggregation. Endogenize weight matrix: Rather imposing fixed spatial network weight matrix, allow connection strengths endogenously determined functions covariates. Account complex dependence structures: Simultaneously accommodate hierarchical, cross-classified, multiple-membership structures, accounting dependence patterns missed conventional models cluster-robust SEs. Partition variance across levels: Estimate residual variance lower higher levels see much heterogeneity attributable level data.","code":""},{"path":"https://benrosche.github.io/bml/index.html","id":"where-can-you-use-bml","dir":"","previous_headings":"bml: Bayesian Multiple-Membership Multilevel Models with Parameterizable Weight Functions","what":"Where can you use bml?","title":"bml","text":"Multiple-membership structures common across social sciences beyond. model developed coalition government data, structure appears many settings, : International relations: Multi-party conflicts, alliances treaties, well international organizations overlapping memberships. Multi-level systems: Subnational units (e.g., regions, states, municipalities) jointly shape national outcomes may simultaneously participate multiple higher-level arrangements. Organization research: Individuals shape team- firm-level outcomes may simultaneously participate multiple teams, well organizations engaged joint ventures interorganizational collaborations. Spatial research: Neighborhoods regions whose outcomes depend combined influence surrounding areas. , bml allows spatial weight matrix endogenized rather imposed ex ante. Network applications: Actors whose outcomes depend combined influence network neighbors (e.g., social, collaboration, communication ties). similar ideas explored earlier work (e.g., Tranmer et al. 2014), bml extends allowing network weight matrix endogenized rather imposed ex ante. cases, bml provides tools model dependence interdependence: just correcting standard errors clustering, explicitly representing lower-level units combine produce higher-level outcomes. following command fits MMMM coalition government data, modeling coalition’s outcome equal-weighted combination member parties’ organizational structure random effects. Parties (pid) can appear multiple governments (gid), party-level covariate org_structure enters model multiple-membership term mm(). weights set w ~ 1 / n (equal weights across n parties coalition), party-specific random effects included via RE = TRUE.","code":"bml(   Y ~ 1 +     majority +     mm(       id = id(pid, gid),       vars = vars(org_structure),       fn = fn(w ~ 1 / n, c = TRUE),       RE = TRUE     ),   family = \"Gaussian\",   data = coalgov ) |>   summary()"},{"path":"https://benrosche.github.io/bml/index.html","id":"learn-more","dir":"","previous_headings":"","what":"Learn more","title":"bml","text":"Rosche, B. (2026). Multilevel Model Coalition Governments: Uncovering Party-Level Dependencies Within Governments. Political Analysis, forthcoming. Preprint","code":""},{"path":"https://benrosche.github.io/bml/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"bml","text":"Install stable version CRAN: install development version GitHub: See installation vignette detailed instructions including JAGS setup.","code":"install.packages(\"bml\") remotes::install_github(\"benrosche/bml\")"},{"path":"https://benrosche.github.io/bml/index.html","id":"developers","dir":"","previous_headings":"","what":"Developers","title":"bml","text":"welcome contributions package! Feel free submit changes review contact questions.","code":""},{"path":"https://benrosche.github.io/bml/index.html","id":"issues-or-feature-requests","dir":"","previous_headings":"","what":"Issues or Feature Requests","title":"bml","text":"like log issue submit feature request, please create new issue GitHub Issues.","code":""},{"path":"https://benrosche.github.io/bml/index.html","id":"changelog","dir":"","previous_headings":"","what":"Changelog","title":"bml","text":"See NEWS.md package changelog.","code":""},{"path":"https://benrosche.github.io/bml/reference/bml.html","id":null,"dir":"Reference","previous_headings":"","what":"Bayesian Multiple-Membership Multilevel Models with Parameterizable Weight Functions Using JAGS — bml","title":"Bayesian Multiple-Membership Multilevel Models with Parameterizable Weight Functions Using JAGS — bml","text":"bml package provides user-friendly interface fitting Bayesian multiple-membership multilevel models parameterizable weight functions via JAGS. JAGS must installed separately: https://sourceforge.net/projects/mcmc-jags/.","code":""},{"path":"https://benrosche.github.io/bml/reference/bml.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Bayesian Multiple-Membership Multilevel Models with Parameterizable Weight Functions Using JAGS — bml","text":"","code":"bml(   formula,   family = \"Gaussian\",   priors = NULL,   inits = NULL,   n.iter = 1000,   n.burnin = 500,   n.thin = max(1, floor((n.iter - n.burnin)/1000)),   n.chains = 3,   seed = NULL,   run = TRUE,   parallel = FALSE,   monitor = TRUE,   modelfile = FALSE,   cox_intervals = NULL,   data = NULL )"},{"path":"https://benrosche.github.io/bml/reference/bml.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Bayesian Multiple-Membership Multilevel Models with Parameterizable Weight Functions Using JAGS — bml","text":"formula symbolic model formula. See 'Formula Components' section details. general structure : outcome ~ 1 + predictors + mm(...) + hm(...). survival models, use Surv(time, event) left-hand side. family Character string specifying outcome distribution link function. Options: \"Gaussian\": Normal distribution identity link (continuous outcomes) \"Binomial\": Binomial distribution logit link (binary outcomes) \"Weibull\": Weibull survival model (requires Surv(time, event) outcome) \"Cox\": Cox proportional hazards model (requires Surv(time, event) outcome) priors Named list character vector JAGS prior specifications. Parameter names follow JAGS naming conventions: Main level: b[x] main-equation coefficients     (e.g., \"b[1] ~ dnorm(0, 0.01)\" intercept) HM level: b.hm.k[x] hm block k coefficients,     tau.hm.k hm block k random effect precision MM level: b.mm.k[x] mm block k coefficients,     b.w.k[x] weight function parameters mm block k,     tau.mm.g mm random effect precision (indexed member-group     ID group g) : shape (Weibull shape parameter),     lambda0[k] (Cox baseline hazard intervals) Note: Priors variance components must specified precision scale (tau = 1/sigma^2), standard deviation, since JAGS parameterizes normal distributions using precision. Example: list(\"b.mm.1 ~ dnorm(0, 0.01)\", \"tau.mm.1 ~ dgamma(2, 0.1)\"). Default priors weakly informative. inits List initial values MCMC chains. Applied chains. NULL, JAGS generates initial values automatically. Weight function parameters (b.w.k) always initialized 0 default prevent numerical instability (e.g., ilogit extreme inputs). User-supplied inits override defaults. n.iter Total number MCMC iterations per chain. Default: 1000. Increase better convergence (e.g., 10000-50000 production models). n.burnin Number burn-iterations discard start chain. Default: 500. sufficient chains reach stationarity. n.thin Thinning rate: save every k-th iteration reduce autocorrelation. Default: max(1, floor((n.iter - n.burnin) / 1000)) (targets ~1000 samples). Increase posterior samples show high autocorrelation. n.chains Number MCMC chains. Default: 3. Use 3-4 chains assess convergence via Gelman-Rubin diagnostics. seed Integer random seed reproducibility. NULL, results vary across runs. run Logical; TRUE (default), JAGS executed model fitted. FALSE, returns model specification without fitting (useful inspecting generated JAGS code data structures). parallel Logical; TRUE, run MCMC chains parallel using multiple cores. Requires parallel backend setup. Default: FALSE. monitor Logical; TRUE, store full MCMC chains additional outputs diagnostic plots. Required monetPlot mcmcDiag. Default: TRUE. modelfile Logical character path: FALSE (default): JAGS code generated internally TRUE: Save generated JAGS code modelstring.txt working directory Character path: Read JAGS code specified file instead generating cox_intervals Cox models : controls baseline hazard flexibility computational efficiency. NULL (default): Non-parametric baseline hazard using unique     event times (maximum flexibility, slower large datasets) Integer k: Piecewise constant baseline hazard k intervals     (faster, suitable datasets many unique event times). Recommended:     k = 10-20 applications. data Data frame member-level (long) format row represents member-level observation. Must contain variables referenced formula, including identifiers specified id().","code":""},{"path":"https://benrosche.github.io/bml/reference/bml.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Bayesian Multiple-Membership Multilevel Models with Parameterizable Weight Functions Using JAGS — bml","text":"list class \"bml\" containing: reg.table: Data frame posterior summaries columns       Parameter, mean, sd, lb, ub       (95% credible interval bounds). w: List weight matrices (one per mm() block).       matrix rows = groups columns = members within group. re.mm: List member-level random effects (one per mmid group       RE = TRUE). Vector standard RE, matrix autoregressive RE. re.hm: List nesting-level random effects (one per hm()       block type = \"RE\"). pred: Vector predicted values (posterior means) group. input: List model specifications including family,       mm hm block info, sample sizes, MCMC settings. jags.: Full R2jags output object (monitor = TRUE;       NULL otherwise). Contains posterior samples, MCMC chains,       convergence diagnostics.","code":""},{"path":"https://benrosche.github.io/bml/reference/bml.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Bayesian Multiple-Membership Multilevel Models with Parameterizable Weight Functions Using JAGS — bml","text":"addition hierarchical cross-classified multilevel models, bml package allows users fit Bayesian multiple-membership models. Unlike tools brms MLwiN, bml lets users specify estimate models membership weights parameterized flexible formula syntax. enables nuanced examination effects member-level units aggregate group level (micro-macro link). package automatically generates JAGS code fit model processes output facilitate interpretation model parameters diagnostics. package modeling framework introduced : Rosche, B. (2026). Multilevel Model Coalition Governments: Uncovering Party-Level Dependencies Within Governments. Political Analysis. accessible introductions multiple-membership models, see Fielding Goldstein (2006) Beretvas (2010). Advanced treatments include Goldstein (2011, Ch. 13), Rasbash Browne (2001, 2008), Browne et al. (2001), Leckie (2013).","code":""},{"path":"https://benrosche.github.io/bml/reference/bml.html","id":"formula-components","dir":"Reference","previous_headings":"","what":"Formula Components","title":"Bayesian Multiple-Membership Multilevel Models with Parameterizable Weight Functions Using JAGS — bml","text":"Outcome (Y): dependent variable. survival models, use Surv(time, event). Intercept: Follows standard R formula conventions (like lm()): y ~ x: Includes intercept default y ~ 1 + x: Explicitly includes intercept (default) y ~ 0 + x y ~ -1 + x: Excludes intercept Main-level predictors (X.main): Variables defined main (group) level, separated +. HM-level predictors (X.hm): Variables defined nesting level, separated +. Multiple membership object (mm()): Defines member-level units         associated group-level constructs using user-specified weighting function.         Multiple mm() objects can specified different weight functions. Hierarchical membership (hm()): Specifies nesting main-level units within         higher-level entities. Cross-classified structures can modeled including multiple hm() objects. Formula Features: main formula vars() specifications support standard R formula syntax: Interactions: Use * main effects plus interaction, : interaction .         Example: y ~ * b expands y ~ + b + :b. Transformations: Use () arithmetic operations.         Example: y ~ (x^2) y ~ (+ b). features work : Main formula: y ~ 1 + * b + (x^2) mm() vars: vars(* b) vars((x^2)) hm() vars: vars(:b) vars((log(x))) Note weight functions: fn() weight function mm() support interactions () transformations. Users must pre-create needed transformed variables data using weight functions. example, instead fn(w ~ b1 * x^2), first create data$x_sq <- data$x^2 use fn(w ~ b1 * x_sq). Note intercepts: Intercept syntax (1, 0, -1) applies main formula. Numeric literals vars() ignored (e.g., vars(1 + x) equivalent vars(x)).","code":""},{"path":"https://benrosche.github.io/bml/reference/bml.html","id":"multiple-membership-object-mm-","dir":"Reference","previous_headings":"","what":"Multiple Membership Object mm()","title":"Bayesian Multiple-Membership Multilevel Models with Parameterizable Weight Functions Using JAGS — bml","text":"Components: id(mmid, mainid): Specifies identifiers linking member-level unit (mmid)         corresponding group-level entities (mainid). vars(X.mm): Specifies member-level covariates aggregated across memberships.         Use + include multiple variables. Supports interactions (*, :)         transformations (()). Set NULL RE-blocks. fn(w ~ ..., c): Defines weight function (micro-macro link).         c parameter controls weight normalization: c = TRUE (default),         weights normalized sum 1 within group         (\\(\\tilde{w}_{ik} = w_{ik} / \\sum_{k} w_{ik}\\)).         Set c = FALSE unnormalized weights (e.g., aggregating sums).         Note: support interactions () - pre-create transformed variables. RE: Logical; TRUE, include random effects block.         Automatically TRUE vars = NULL. ar: Logical; TRUE, member-level random effects evolve         random walk across repeated participations groups. captures dynamics         member's unobserved heterogeneity changes time. Default: FALSE. Multiple mm() blocks: can specify multiple mm() blocks different weight functions. However, RE = TRUE can specified one mm() block.","code":"mm(   id   = id(mmid, mainid),   vars = vars(X.mm),   fn   = fn(w ~ 1/n, c = TRUE),   RE   = TRUE,   ar   = FALSE ) mm(id = id(pid, gid), vars = vars(X.mm.1), fn = fn(w ~ 1/n), RE = FALSE) + mm(id = id(pid, gid), vars = vars(X.mm.2), fn = fn(w ~ pseat == max(pseat)), RE = FALSE) + mm(id = id(pid, gid), vars = NULL, fn = fn(w ~ 1/n), RE = TRUE)"},{"path":"https://benrosche.github.io/bml/reference/bml.html","id":"hierarchical-membership-object-hm-","dir":"Reference","previous_headings":"","what":"Hierarchical Membership Object hm()","title":"Bayesian Multiple-Membership Multilevel Models with Parameterizable Weight Functions Using JAGS — bml","text":"Components: id = id(hmid): Variable identifying nesting-level groups. vars = vars(X.hm): Nesting-level variables, NULL.         Supports interactions (*, :) transformations (()). name = hmname: Optional labels nesting-level units. type: \"RE\" (default) \"FE\". showFE: TRUE type = \"FE\", report fixed effects.","code":"hm(id = id(hmid), vars = vars(X.hm), name = hmname, type = \"RE\", showFE = FALSE)"},{"path":"https://benrosche.github.io/bml/reference/bml.html","id":"supported-families-links","dir":"Reference","previous_headings":"","what":"Supported Families / Links","title":"Bayesian Multiple-Membership Multilevel Models with Parameterizable Weight Functions Using JAGS — bml","text":"Gaussian (continuous): family = \"Gaussian\" Binomial (logistic): family = \"Binomial\" Weibull survival: family = \"Weibull\", outcome: Surv(time, event) Cox survival: family = \"Cox\", outcome: Surv(time, event)","code":""},{"path":"https://benrosche.github.io/bml/reference/bml.html","id":"priors","dir":"Reference","previous_headings":"","what":"Priors","title":"Bayesian Multiple-Membership Multilevel Models with Parameterizable Weight Functions Using JAGS — bml","text":"Priors can specified parameters. multiple mm() blocks, use indexed names:","code":"priors = list(   \"b.mm.1 ~ dnorm(0, 0.01)\",   \"b.w.1 ~ dnorm(0, 0.1)\",   \"tau.mm.1 ~ dscaled.gamma(25, 1)\" )"},{"path":"https://benrosche.github.io/bml/reference/bml.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Bayesian Multiple-Membership Multilevel Models with Parameterizable Weight Functions Using JAGS — bml","text":"Rosche, B. (2026). Multilevel Model Coalition Governments: Uncovering Party-Level Dependencies Within Governments. Political Analysis. Browne, W. J., Goldstein, H., & Rasbash, J. (2001). Multiple membership multiple classification (MMMC) models. Statistical Modelling, 1(2), 103-124.","code":""},{"path":[]},{"path":"https://benrosche.github.io/bml/reference/bml.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Bayesian Multiple-Membership Multilevel Models with Parameterizable Weight Functions Using JAGS — bml","text":"Benjamin Rosche <benrosche@nyu.edu>","code":""},{"path":"https://benrosche.github.io/bml/reference/bml.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Bayesian Multiple-Membership Multilevel Models with Parameterizable Weight Functions Using JAGS — bml","text":"","code":"if (FALSE) { # \\dontrun{ data(coalgov)  # Basic multiple-membership model # Parties (pid) within governments (gid), nested in countries (cid) m1 <- bml(   Surv(dur_wkb, event_wkb) ~ 1 + majority +     mm(       id   = id(pid, gid),       vars = vars(cohesion),       fn   = fn(w ~ 1/n, c = TRUE),       RE   = TRUE     ) +     hm(id = id(cid), type = \"RE\"),   family = \"Weibull\",   data   = coalgov )  # View results summary(m1) monetPlot(m1, \"b[2]\")  # Plot for majority coefficient  # Multiple mm() blocks with different weight functions m2 <- bml(   Surv(dur_wkb, event_wkb) ~ 1 + majority +     mm(id = id(pid, gid), vars = vars(cohesion),        fn = fn(w ~ cohesion == max(cohesion)), RE = FALSE) +     mm(id = id(pid, gid), vars = NULL, fn = fn(w ~ 1/n), RE = TRUE),   family = \"Weibull\",   data   = coalgov )  # Cox model with piecewise baseline hazard (faster for large datasets) m3 <- bml(   Surv(dur_wkb, event_wkb) ~ 1 + majority +     mm(id = id(pid, gid), vars = vars(cohesion), fn = fn(w ~ 1/n), RE = TRUE),   family = \"Cox\",   cox_intervals = 10,  # Use 10 intervals instead of all unique times   data   = coalgov )  # Parameterized weight function # ilogit() bounds raw weights between 0 and 1; c = TRUE normalizes to sum to 1 m4 <- bml(   Surv(dur_wkb, event_wkb) ~ 1 + majority +     mm(       id   = id(pid, gid),       vars = vars(cohesion),       fn   = fn(w ~ ilogit(b0 + b1 * pseat), c = TRUE),       RE   = FALSE     ),   family = \"Weibull\",   data   = coalgov )  # Fixed coefficients (offsets) m5 <- bml(   Surv(dur_wkb, event_wkb) ~ 1 + fix(majority, 1) + # Fix majority coefficient to 1.0     mm(       id   = id(pid, gid),       vars = vars(rile),       fn   = fn(w ~ 1/n, c = TRUE),       RE   = FALSE     ),   family = \"Weibull\",   data   = coalgov )  # Custom priors m6 <- bml(   Surv(dur_wkb, event_wkb) ~ 1 + majority +     mm(id = id(pid, gid), vars = vars(cohesion), fn = fn(w ~ 1/n), RE = TRUE),   family = \"Weibull\",   priors = list(     \"b[1] ~ dnorm(0, 0.01)\",       # Intercept prior     \"b.mm.1 ~ dnorm(0, 0.1)\",      # MM coefficient prior     \"tau.mm.1 ~ dgamma(2, 0.5)\"    # MM precision prior   ),   data   = coalgov )  # Cross-classified model (multiple hm blocks) # Governments are cross-classified by country and election year m7 <- bml(   Surv(dur_wkb, event_wkb) ~ 1 + majority +     mm(id = id(pid, gid), vars = vars(cohesion), fn = fn(w ~ 1/n), RE = TRUE) +     hm(id = id(cid), type = \"RE\") +     hm(id = id(year), type = \"RE\"),   family = \"Weibull\",   data   = coalgov |> mutate(year = format(election, \"%Y\") |> as.integer()) ) } # }"},{"path":"https://benrosche.github.io/bml/reference/coalgov.html","id":null,"dir":"Reference","previous_headings":"","what":"Coalition Governments in Western Democracies (1944-2014) — coalgov","title":"Coalition Governments in Western Democracies (1944-2014) — coalgov","text":"dataset containing information coalition governments member parties across 30 parliamentary democracies. data long format unit analysis parties governments, making suitable multiple-membership multilevel models governments (groups) composed multiple parties (members).","code":""},{"path":"https://benrosche.github.io/bml/reference/coalgov.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Coalition Governments in Western Democracies (1944-2014) — coalgov","text":"","code":"coalgov"},{"path":"https://benrosche.github.io/bml/reference/coalgov.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Coalition Governments in Western Democracies (1944-2014) — coalgov","text":"tibble 2,077 rows 18 variables. row represents party's   participation specific coalition government. sample contains 628 governments   formed 312 unique parties across 29 countries. Identifiers: gid Government identifier (group-level unit mm() specification).     Range: [3, 1105] pid Party identifier (member-level unit mm() specification).     Range: [11110, 96955] cid Country identifier (nesting-level unit hm() specification).     Range: [11, 96] cname Three-letter country code (ISO 3166-1 alpha-3) pname Full party name Government-level variables: election Date preceding election led government's formation.     Range: [1939-04-02, 2014-12-14] n Number parties coalition (group size weight functions).     Range: [2, 9], mean: 3.31 dur_wkb Government duration days, measured investiture termination     (outcome variable survival models). Range: [7, 1840], mean: 554.5 event_wkb Early termination indicator: 1 = government terminated due     political conflict (voluntary resignation, dissension within government, lack     parliamentary support, head state intervention) one year     official end term; 0 = censored (regular elections, reasons,     termination within one year scheduled elections). Range: [0, 1], mean: 0.39 majority Majority government indicator: 1 = coalition controls majority     parliamentary seats, 0 = minority government. Range: [0, 1], mean: 0.80 mwc Minimal winning coalition indicator: 1 = coalition lose majority     party left, 0 = oversized coalition. Range: [0, 1], mean: 0.35 rile_SD Inter-party ideological heterogeneity. Standard deviation coalition     parties' left-right positions (CMP) relative ideological distribution     parties parliament. Standardized inverted higher values indicate     greater ideological cohesion. Range: [-8.40, 2.12], mean: 0.04 Country-level variables: investiture Investiture vote requirement (time-constant country characteristic):     1 = country requires formal parliamentary investiture vote, 0 = formal requirement.     Range: [0, 1], mean: 0.46 Party-level variables: pseat Party's relative seat share within coalition, computed     pseat / sum(pseat) within government. Sums 1 within coalition.     Range: [0.00, 1.00], mean: 0.33 prime Prime minister party indicator: TRUE = party holds prime     ministership (n = 628), FALSE = junior coalition partner (n = 1,449) cohesion Intra-party ideological cohesion, measured using adaptation     Cowles-Jones ratio. Computed ratio continuous ideological shifts     reversals party's left-right position time. Higher values indicate     consistent ideological trajectories (greater cohesion). Standardized.     Range: [-1.13, 3.85], mean: 0.00 rile Party's left-right ideological position (CMP). Measured     continuous scale higher values indicate right-wing positions lower     values indicate left-wing positions. Standardized.     Range: [-3.21, 3.68], mean: 0.00 finance Party's economic dependence member contributions (PPDB).     Measured share party funding member dues relative total income.     Standardized; higher values indicate greater dependence member financing.     Treated time-constant due data limitations. Range: [-0.98, 4.40], mean: 0.00 Nmembers Number party members (PPDB). Standardized; treated     time-constant due data limitations. Range: [-0.33, 15.02], mean: 0.00","code":""},{"path":"https://benrosche.github.io/bml/reference/coalgov.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Coalition Governments in Western Democracies (1944-2014) — coalgov","text":"Data compiled multiple sources: Coalition governments: Woldendorp, Keman, Budge (WKB) dataset,     updated Seki Williams (2014) Party ideology: Comparative Manifesto Project (CMP; Volkens et al. 2016) Party organization: Political Party Database (PPDB; Scarrow, Poguntke,     Webb 2017) Missing party-level data imputed using multiple imputation chained equations predictive mean matching.","code":""},{"path":"https://benrosche.github.io/bml/reference/coalgov.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Coalition Governments in Western Democracies (1944-2014) — coalgov","text":"dataset demonstrates multiple-membership multilevel modeling : Members: Political parties (identified pid) Groups: Coalition governments (identified gid) Nesting: Governments nested within countries (identified cid) coalition government comprises multiple parties, parties can participate multiple governments time. creates multiple-membership structure party-level characteristics aggregated government level using weighting functions specified mm() blocks. Sample: matching party data across sources excluding single-party caretaker governments, sample comprises 628 governments formed 312 unique parties across 29 countries: Australia, Austria, Belgium, Bulgaria, Croatia, Czech Republic, Denmark, Estonia, Finland, France, Germany, Greece, Hungary, Ireland, Israel, Italy, Japan, Latvia, Lithuania, Netherlands, Norway, Poland, Portugal, Romania, Slovakia, Spain, Sweden, Switzerland, United Kingdom. Measurement notes: Government duration follows WKB convention: time investiture     termination new elections Early termination events focus political gridlock (conflict-related endings)     exclude terminations within one year scheduled elections Party-level variables (cohesion, finance, Nmembers)     standardized (mean = 0) analysis","code":""},{"path":"https://benrosche.github.io/bml/reference/coalgov.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Coalition Governments in Western Democracies (1944-2014) — coalgov","text":"Seki, K., & Williams, L. K. (2014). Updating Party Government data set. Electoral Studies, 34, 270-279. Volkens, ., et al. (2016). Manifesto Data Collection. Manifesto Project (MRG/CMP/MARPOR). Version 2016a. Berlin: Wissenschaftszentrum Berlin fur Sozialforschung. Scarrow, S. E., Webb, P. D., & Poguntke, T. (Eds.). (2017). Organizing Political Parties: Representation, Participation, Power. Oxford University Press.","code":""},{"path":[]},{"path":"https://benrosche.github.io/bml/reference/coalgov.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Coalition Governments in Western Democracies (1944-2014) — coalgov","text":"","code":"data(coalgov)  # Explore data structure str(coalgov) #> 'data.frame':\t1288 obs. of  27 variables: #>  $ pid        : num  2 6 2 6 2 6 3 5 6 3 ... #>   ..- attr(*, \"label\")= chr \"Unique party ID\" #>   ..- attr(*, \"format.stata\")= chr \"%9.0g\" #>  $ pname      : chr  \"Social Democratic Labour Party\" \"Agrarian Party\" \"Social Democratic Labour Party\" \"Agrarian Party\" ... #>   ..- attr(*, \"label\")= chr \"Party name\" #>   ..- attr(*, \"format.stata\")= chr \"%-50s\" #>  $ gid        : num  1 1 2 2 3 3 4 4 4 5 ... #>   ..- attr(*, \"label\")= chr \"Unique government ID\" #>   ..- attr(*, \"format.stata\")= chr \"%9.0g\" #>  $ gname      : chr  \"Erlander III\" \"Erlander III\" \"Erlander IV\" \"Erlander IV\" ... #>   ..- attr(*, \"label\")= chr \"Government name\" #>   ..- attr(*, \"format.stata\")= chr \"%21s\" #>  $ cid        : num  1 1 1 1 1 1 1 1 1 1 ... #>   ..- attr(*, \"label\")= chr \"Unique country ID\" #>   ..- attr(*, \"format.stata\")= chr \"%9.0g\" #>  $ cname      : chr  \"Sweden\" \"Sweden\" \"Sweden\" \"Sweden\" ... #>   ..- attr(*, \"label\")= chr \"Country name\" #>   ..- attr(*, \"format.stata\")= chr \"%26s\" #>  $ gstart     : Date, format: \"1951-09-30\" \"1951-09-30\" ... #>  $ gend       : Date, format: \"1952-09-21\" \"1952-09-21\" ... #>  $ n          : num  2 2 2 2 2 2 3 3 3 3 ... #>   ..- attr(*, \"label\")= chr \"# government parties\" #>   ..- attr(*, \"format.stata\")= chr \"%9.0g\" #>  $ prime      : num  1 0 1 0 1 0 0 0 1 0 ... #>   ..- attr(*, \"label\")= chr \"Prime minister party\" #>   ..- attr(*, \"format.stata\")= chr \"%9.0g\" #>  $ pfam       : hvn_lbll [1:1288] 3, 8, 3, 8, 3, 8, 4, 6, 8, 4, 6, 8, 4, 8, 4, 5, 6, 8... #>    ..@ label       : chr \"Party family\" #>    ..@ format.stata: chr \"%13.0g\" #>    ..@ labels      : Named num  1 2 3 4 5 6 7 8 9 10 #>    .. ..- attr(*, \"names\")= chr [1:10] \"ecologist\" \"communist\" \"socdem\" \"liberal\" ... #>  $ rile       : num  -33.4 -4.9 -28.3 1.2 -44.2 1.8 -2.1 2.2 -18.2 -15.2 ... #>   ..- attr(*, \"label\")= chr \"Right-left position\" #>   ..- attr(*, \"format.stata\")= chr \"%5.2f\" #>  $ ipd        : num  0.25 0 0.25 0 0.25 0 0 0 0 0 ... #>   ..- attr(*, \"label\")= chr \"Intra-party democracy\" #>   ..- attr(*, \"format.stata\")= chr \"%10.0g\" #>  $ fdep       : num  20.2 1.57 20.2 1.57 20.2 ... #>   ..- attr(*, \"label\")= chr \"Financial dependency\" #>   ..- attr(*, \"format.stata\")= chr \"%9.0g\" #>  $ pseatrel   : num  0.577 -0.577 0.618 -0.618 0.696 ... #>   ..- attr(*, \"label\")= chr \"Party's relative seat share within coalition\" #>   ..- attr(*, \"format.stata\")= chr \"%9.0g\" #>  $ majority   : num  0 0 0 0 0 0 1 1 1 1 ... #>   ..- attr(*, \"label\")= chr \"Majority government\" #>   ..- attr(*, \"format.stata\")= chr \"%9.0g\" #>  $ mwc        : num  1 1 1 1 1 1 1 1 1 1 ... #>   ..- attr(*, \"label\")= chr \"Minimal winning coalition\" #>   ..- attr(*, \"format.stata\")= chr \"%9.0g\" #>  $ hetero     : num  0.49 0.49 0.631 0.631 0.793 ... #>   ..- attr(*, \"label\")= chr \"SD(rile) of goverment / SD(rile) of parliament\" #>   ..- attr(*, \"format.stata\")= chr \"%9.0g\" #>  $ investiture: num  1 1 1 1 1 1 1 1 1 1 ... #>   ..- attr(*, \"label\")= chr \"Investiture vote\" #>   ..- attr(*, \"format.stata\")= chr \"%10.0g\" #>  $ pmpower    : num  3 3 3 3 3 3 3 3 3 3 ... #>   ..- attr(*, \"label\")= chr \"Prime ministerial powers\" #>   ..- attr(*, \"format.stata\")= chr \"%10.0g\" #>  $ earlyterm  : num  0 0 0 0 1 1 1 1 1 1 ... #>   ..- attr(*, \"label\")= chr \"Discretionary early termination\" #>   ..- attr(*, \"format.stata\")= chr \"%9.0g\" #>  $ govdur     : num  357 357 1466 1466 399 ... #>   ..- attr(*, \"label\")= chr \"Government duration\" #>   ..- attr(*, \"format.stata\")= chr \"%9.0g\" #>  $ govmaxdur  : num  357 357 1466 1466 1451 ... #>   ..- attr(*, \"label\")= chr \"Maximum possible government duration\" #>  $ sim.w      : num  0.326 0.318 0.327 0.319 0.327 ... #>   ..- attr(*, \"label\")= chr \"Simulated weights\" #>   ..- attr(*, \"format.stata\")= chr \"%9.0g\" #>  $ sim.y      : num  24.7 24.7 24.4 24.4 23.5 ... #>   ..- attr(*, \"label\")= chr \"Simulated linear outcome\" #>   ..- attr(*, \"format.stata\")= chr \"%9.0g\" #>  $ sim.st     : num  2.42e-10 2.77e-09 5.43e-10 1.92e-10 1.21e-09 ... #>   ..- attr(*, \"label\")= chr \"Simulated survival time\" #>  $ sim.e      : num  1 1 1 1 1 1 1 1 1 1 ... #>   ..- attr(*, \"label\")= chr \"Simulated event status\" table(coalgov$cname) #>  #>      Australia        Austria        Belgium Czech Republic        Denmark  #>             46             45            150             31             76  #>         France        Germany        Hungary        Ireland         Israel  #>            182             57             19             34            252  #>          Italy    Netherlands         Norway         Poland       Portugal  #>            196             74             40             42             10  #>          Spain         Sweden United Kingdom  #>              4             28              2   # Number of unique units length(unique(coalgov$gid))   # Governments #> [1] 402 length(unique(coalgov$pid))   # Parties #> [1] 194 length(unique(coalgov$cid))   # Countries #> [1] 18  if (FALSE) { # \\dontrun{ # Model: government duration as function of majority status and party characteristics m1 <- bml(   Surv(dur_wkb, event_wkb) ~ 1 + majority +     mm(id = id(pid, gid), vars = vars(finance), fn = fn(w ~ 1/n), RE = TRUE) +     hm(id = id(cid), type = \"RE\"),   family = \"Weibull\",   data = coalgov ) summary(m1) } # }"},{"path":"https://benrosche.github.io/bml/reference/fix.html","id":null,"dir":"Reference","previous_headings":"","what":"Fix a coefficient to a known value — fix","title":"Fix a coefficient to a known value — fix","text":"Specify covariate whose coefficient held constant fixed value rather estimated data. useful offset variables want impose theoretical constraints. Fixed coefficients handled efficiently pre-computing contribution R passing data JAGS.","code":""},{"path":"https://benrosche.github.io/bml/reference/fix.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fix a coefficient to a known value — fix","text":"","code":"fix(var, value)"},{"path":"https://benrosche.github.io/bml/reference/fix.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fix a coefficient to a known value — fix","text":"var Unquoted variable name data value Numeric value coefficient (e.g., 1.0 standard offset)","code":""},{"path":"https://benrosche.github.io/bml/reference/fix.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fix a coefficient to a known value — fix","text":"bml_fix object can used within vars.","code":""},{"path":[]},{"path":"https://benrosche.github.io/bml/reference/fix.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Fix a coefficient to a known value — fix","text":"","code":"if (FALSE) { # \\dontrun{ # Fix a coefficient to 1.0 (standard offset) fix(exposure, 1.0)  # Use within vars() for multiple-membership models vars(fix(population, 0.5) + income + education) } # }"},{"path":"https://benrosche.github.io/bml/reference/fn.html","id":null,"dir":"Reference","previous_headings":"","what":"Specify a weight function for multiple-membership models — fn","title":"Specify a weight function for multiple-membership models — fn","text":"Defines member-level contributions weighted aggregating group level (\"micro-macro link\"). weight function can simple formula (e.g., 1/n equal weights) can include parameters estimated data.","code":""},{"path":"https://benrosche.github.io/bml/reference/fn.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Specify a weight function for multiple-membership models — fn","text":"","code":"fn(w = w ~ 1/n, c = TRUE)"},{"path":"https://benrosche.github.io/bml/reference/fn.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Specify a weight function for multiple-membership models — fn","text":"w two-sided formula specifying weight function. left-hand side must w; right-hand side defines weighting scheme: Simple: w ~ 1/n (equal weights based group size) Parameterized: w ~ b0 + b1 * tenure (weights depend     member characteristics estimated parameters) group aggregates: w ~ b1 * min(x) + (1-b1) * mean(x)     (weights based group-level summaries; see Details) Parameters must named b0, b1, b2, etc. c Logical; TRUE (default), weights normalized sum 1 within group. Set FALSE unnormalized weights.","code":""},{"path":"https://benrosche.github.io/bml/reference/fn.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Specify a weight function for multiple-membership models — fn","text":"bml_fn object containing parsed weight function specification.","code":""},{"path":"https://benrosche.github.io/bml/reference/fn.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Specify a weight function for multiple-membership models — fn","text":"Weight Function Components: Variables (e.g., n, tenure): Data dataset Parameters (e.g., b0, b1): Estimated data Operations: Standard R arithmetic (+, -, *,     /, ^, etc.) Common Weight Functions: Equal weights: w ~ 1/n Duration-based: w ~ duration Flexible parameterized: w ~ b0 + b1 * seniority Group aggregates: w ~ b1 * min(x) + (1-b1) * mean(x) c = TRUE, weights constrained: \\(\\sum_{k \\group} w_k = 1\\). Group-Level Aggregation Functions: weight function supports aggregation functions compute summaries within group (mainid). pre-computed R passing JAGS. Supported functions: min(var), max(var): Minimum/maximum value within group mean(var), sum(var): Mean/sum values within group median(var), mode(var): Median/mode (frequent) value within group sd(var), var(var), range(var): Standard deviation/variance/range (max-min) within group first(var), last(var): First/last value (based data order) quantile(var, prob): Quantile probability prob (0 1).     example, quantile(x, 0.25) computes 25th percentile. Example: fn(w ~ b1 * min(tenure) + (1-b1) * max(tenure)) creates weights blend minimum maximum tenure within group, blend controlled estimated parameter b1. Example quantile: fn(w ~ quantile(tenure, 0.75) / max(tenure)) uses 75th percentile relative maximum within group. Note: Nested aggregation functions (e.g., min(max(x))) supported. JAGS Mathematical Functions: following mathematical functions passed directly JAGS can used weight formulas: exp, log, log10, sqrt, abs, pow sin, cos, tan, asin, acos, atan sinh, cosh, tanh logit, ilogit, probit, iprobit, cloglog, icloglog round, trunc, floor, ceiling Example: fn(w ~ 1 / (1 + (n - 1) * exp(-(b1 * x)))) uses exponential decay function weights depend member characteristics. Ensuring Numerical Stability: Weight functions estimated parameters (b0, b1, ...) must produce bounded, positive values across plausible parameter values. Unbounded weight functions can cause MCMC sampler crash (e.g., \"Error node w.1[...]: Invalid parent values\"). sampling, weight parameters can take extreme values, weight function bounded, destabilize likelihood. Recommendations: Use bounded weight functions. Two options: ilogit(): Bounds weights 0 1 zero-point         0.5: fn(w ~ ilogit(b0 + b1 * x), c = TRUE) Generalized logistic (Rosche, 2026): Bounds weights         0 1 zero-point \\(1/n\\) (equal weights), deviations         equal weighting estimated function covariates:         fn(w ~ 1 / (1 + (n - 1) * exp(-(b0 + b1 * x))), c = TRUE) Use c = TRUE (weight normalization) prevent weights     growing without bound Standardize covariates weight function. Variables     large ranges (e.g., income thousands) can cause b * x overflow Use informative priors weight parameters via     priors argument bml (e.g.,     priors = list(\"b.w.1[1] ~ dnorm(0, 1)\")) Avoid unbounded functions like exp(b * x) without     normalization (c = TRUE) wrapping (e.g., inside ilogit()) Weight parameters initialized 0 default ensure numerically stable starting values. See vignette(\"faq\") (Question 7) detailed troubleshooting numerical issues.","code":""},{"path":"https://benrosche.github.io/bml/reference/fn.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Specify a weight function for multiple-membership models — fn","text":"Rosche, B. (2026). Multilevel Model Theorizing Estimating Micro-Macro Link. Political Analysis. Browne, W. J., Goldstein, H., & Rasbash, J. (2001). Multiple membership multiple classification (MMMC) models. Statistical Modelling, 1(2), 103-124.","code":""},{"path":[]},{"path":"https://benrosche.github.io/bml/reference/fn.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Specify a weight function for multiple-membership models — fn","text":"","code":"if (FALSE) { # \\dontrun{ # Equal weights (standard multiple-membership) fn(w ~ 1/n, c = TRUE)  # Tenure-based weights (proportional to time served) fn(w ~ tenure, c = TRUE)  # Flexible parameterized weights fn(w ~ b0 + b1 * seniority, c = TRUE)  # Unconstrained weights fn(w ~ importance, c = FALSE)  # Weights based on group aggregates fn(w ~ b1 * min(tenure) + (1 - b1) * mean(tenure), c = TRUE)  # Combining individual and aggregate measures fn(w ~ b0 + b1 * (tenure / max(tenure)), c = TRUE)  # Using median for robust central tendency fn(w ~ tenure / median(tenure), c = TRUE)  # Using quantiles for percentile-based weights fn(w ~ quantile(tenure, 0.75) - quantile(tenure, 0.25), c = TRUE) } # }"},{"path":"https://benrosche.github.io/bml/reference/hm.html","id":null,"dir":"Reference","previous_headings":"","what":"Define a hierarchical nesting structure — hm","title":"Define a hierarchical nesting structure — hm","text":"Specifies hierarchical (nesting) level model group-level units nested within higher-level entities. Unlike multiple-membership structures, group belongs exactly one nesting-level unit. Can model either random effects fixed effects nesting level.","code":""},{"path":"https://benrosche.github.io/bml/reference/hm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Define a hierarchical nesting structure — hm","text":"","code":"hm(id, vars = NULL, name = NULL, type = \"RE\", showFE = FALSE, ar = FALSE)"},{"path":"https://benrosche.github.io/bml/reference/hm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Define a hierarchical nesting structure — hm","text":"id id object specifying nesting-level identifier: id(hmid) hmid identifies higher-level units (e.g., countries, regions). vars vars object specifying nesting-level covariates, NULL intercept-effects. Supports interactions (*, :) transformations (()). name Unquoted variable name nesting-level labels (optional). provided, labels displayed model output fixed effects. type Character; either \"RE\" random effects (default) \"FE\" fixed effects nesting level. showFE Logical; TRUE type = \"FE\", fixed effect estimates nesting-level unit included output. Default: FALSE. ar Logical; TRUE, random effects evolve autoregressively across participations nesting level. Requires sequential participation indicators data. Default: FALSE.","code":""},{"path":"https://benrosche.github.io/bml/reference/hm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Define a hierarchical nesting structure — hm","text":"bml_hm object containing hierarchical specification.","code":""},{"path":"https://benrosche.github.io/bml/reference/hm.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Define a hierarchical nesting structure — hm","text":"Hierarchical vs. Multiple-Membership: Hierarchical structures (hm) model strict nesting: group belongs exactly one higher-level unit. Use mm groups can memberships multiple units. Random vs. Fixed Effects: Random effects (type = \"RE\"): Nesting-level units     treated random sample population. Best many units     want generalize. Fixed effects (type = \"FE\"): unit gets     parameter. Best units want estimate unit-specific effects. Cross-Classification: Multiple hm() blocks create cross-classified models groups simultaneously nested within multiple non-nested hierarchies (e.g., schools within neighborhoods districts).","code":""},{"path":"https://benrosche.github.io/bml/reference/hm.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Define a hierarchical nesting structure — hm","text":"Goldstein, H. (2011). Multilevel Statistical Models (4th ed.). Wiley. Rabe-Hesketh, S., & Skrondal, . (2012). Multilevel Longitudinal Modeling Using Stata (3rd ed.). Stata Press.","code":""},{"path":[]},{"path":"https://benrosche.github.io/bml/reference/hm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Define a hierarchical nesting structure — hm","text":"","code":"if (FALSE) { # \\dontrun{ # Random effects with covariates hm(   id = id(cid),   vars = vars(gdp + democracy),   name = cname,   type = \"RE\" )  # Random intercepts only hm(   id = id(cid),   vars = NULL,   type = \"RE\" )  # Fixed effects hm(   id = id(cid),   vars = NULL,   name = cname,   type = \"FE\",   showFE = TRUE  # Show estimates for each country )  # Autoregressive random effects hm(   id = id(cid),   vars = NULL,   type = \"RE\",   ar = TRUE  # Effects evolve over time ) } # }"},{"path":"https://benrosche.github.io/bml/reference/id.html","id":null,"dir":"Reference","previous_headings":"","what":"Specify identifier variables for multiple-membership and hierarchical structures — id","title":"Specify identifier variables for multiple-membership and hierarchical structures — id","text":"Helper function used within mm hm specify identifier variables define memberships nesting structures. multiple-membership models, id() links member-level units (e.g., party IDs) group-level units (e.g., government IDs). hierarchical models, id() specifies nesting-level identifier (e.g., country ID).","code":""},{"path":"https://benrosche.github.io/bml/reference/id.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Specify identifier variables for multiple-membership and hierarchical structures — id","text":"","code":"id(...)"},{"path":"https://benrosche.github.io/bml/reference/id.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Specify identifier variables for multiple-membership and hierarchical structures — id","text":"... Unquoted variable names data: mm(): Two identifiers id(mmid, mainid)     mmid identifies member-level units mainid identifies     group-level units hm(): One identifier id(hmid) hmid     identifies nesting-level units","code":""},{"path":"https://benrosche.github.io/bml/reference/id.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Specify identifier variables for multiple-membership and hierarchical structures — id","text":"bml_id object containing variable names character strings.","code":""},{"path":[]},{"path":"https://benrosche.github.io/bml/reference/id.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Specify identifier variables for multiple-membership and hierarchical structures — id","text":"","code":"if (FALSE) { # \\dontrun{ # Multiple-membership: parties (pid) within governments (gid) id(pid, gid)  # Hierarchical: governments within countries id(cid) } # }"},{"path":"https://benrosche.github.io/bml/reference/mcmcDiag.html","id":null,"dir":"Reference","previous_headings":"","what":"Summarize MCMC convergence diagnostics — mcmcDiag","title":"Summarize MCMC convergence diagnostics — mcmcDiag","text":"Computes common convergence diagnostics selected parameters JAGS/BUGS fit returns compact, report-ready table. diagnostics include Gelman–Rubin \\(\\hat{R}\\), Geweke z-scores, Heidelberger-Welch stationarity p-values, autocorrelation user-specified lag.","code":""},{"path":"https://benrosche.github.io/bml/reference/mcmcDiag.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summarize MCMC convergence diagnostics — mcmcDiag","text":"","code":"mcmcDiag(bml.out, parameters, lag = 50)"},{"path":"https://benrosche.github.io/bml/reference/mcmcDiag.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summarize MCMC convergence diagnostics — mcmcDiag","text":"bml.model fit object containing JAGS output, typically returned R2jags::jags(), component $jags.$BUGSoutput. parameters Character vector parameter names (patterns) extract. may exact names patterns (e.g., prefix like \"b\" matches \"b[1]\", \"b[2]\", …). lag Integer specifying lag compute autocorrelation. Default: 50. Lower values (e.g., 10) capture short-range dependence; higher values assess whether chain mixed well longer intervals.","code":""},{"path":"https://benrosche.github.io/bml/reference/mcmcDiag.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summarize MCMC convergence diagnostics — mcmcDiag","text":"data.frame one row per diagnostic one column per   parameter; cell entries average diagnostic values across chains.   Row names include: \"Gelman/Rubin convergence statistic\",   \"Geweke z-score\", \"Heidelberger/Welch p-value\",   \"Autocorrelation (lag <lag>)\".","code":""},{"path":"https://benrosche.github.io/bml/reference/mcmcDiag.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Summarize MCMC convergence diagnostics — mcmcDiag","text":"Internally, function converts BUGS/JAGS output coda::mcmc.list, computes per-chain diagnostics averages across chains parameter: Gelman–Rubin (\\(\\hat{R}\\)): coda::gelman.diag().         Values close 1 indicate convergence; common heuristic         \\(\\hat{R} \\le 1.1\\). Geweke z-score: coda::geweke.diag().         Large absolute values (e.g., \\(|z|>2\\)) suggest lack convergence. Heidelberger–Welch p-value: coda::heidel.diag() tests         null stationarity chain segment. Autocorrelation: coda::autocorr() specified         lag, averaged across chains. Values near zero indicate good         mixing; persistent autocorrelation suggests chain needs thinning         reparameterization. statistics rounded three decimals. returned table transposed rows diagnostics columns parameters.","code":""},{"path":"https://benrosche.github.io/bml/reference/mcmcDiag.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Summarize MCMC convergence diagnostics — mcmcDiag","text":"Gelman, ., & Rubin, D. B. (1992). Inference iterative simulation using multiple sequences. Statistical Science, 7(4), 457-472. Brooks, S. P., & Gelman, . (1998). General methods monitoring convergence iterative simulations. Journal Computational Graphical Statistics, 7(4), 434-455.","code":""},{"path":[]},{"path":"https://benrosche.github.io/bml/reference/mcmcDiag.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Summarize MCMC convergence diagnostics — mcmcDiag","text":"Benjamin Rosche benrosche@nyu.edu","code":""},{"path":"https://benrosche.github.io/bml/reference/mcmcDiag.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Summarize MCMC convergence diagnostics — mcmcDiag","text":"","code":"if (FALSE) { # \\dontrun{ data(coalgov)  # Fit model m1 <- bml(   Surv(dur_wkb, event_wkb) ~ 1 + majority +     mm(id = id(pid, gid), vars = vars(cohesion), fn = fn(w ~ 1/n), RE = TRUE),   family = \"Weibull\",   monitor = TRUE,   data = coalgov )  # Check convergence for main parameters mcmcDiag(m1, parameters = \"b\")  # All b coefficients  # Check specific parameters mcmcDiag(m1, parameters = c(\"b[1]\", \"b[2]\", \"shape\"))  # Check mm block parameters mcmcDiag(m1, parameters = c(\"b.mm.1\", \"sigma.mm.1\"))  # Custom autocorrelation lag mcmcDiag(m1, parameters = \"b\", lag = 100)  # Interpreting results: # - Gelman-Rubin < 1.1: Good convergence # - |Geweke z| < 2: No evidence against convergence # - Heidelberger p > 0.05: Chain appears stationary # - Low autocorrelation: Good mixing } # }"},{"path":"https://benrosche.github.io/bml/reference/mm.html","id":null,"dir":"Reference","previous_headings":"","what":"Define a multiple-membership structure — mm","title":"Define a multiple-membership structure — mm","text":"Specifies multiple-membership level model group-level units (e.g., governments) composed multiple member-level units (e.g., political parties). Unlike pure hierarchical nesting, members can belong multiple groups, contributions aggregated using user-specified weight function.","code":""},{"path":"https://benrosche.github.io/bml/reference/mm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Define a multiple-membership structure — mm","text":"","code":"mm(id, vars = NULL, fn = NULL, RE = NULL, ar = FALSE)"},{"path":"https://benrosche.github.io/bml/reference/mm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Define a multiple-membership structure — mm","text":"id id object specifying member-level group-level identifiers: id(mmid, mainid) mmid identifies members mainid identifies groups. vars vars object specifying member-level covariates aggregate, NULL random effects . Supports interactions (*, :) transformations (()). Variables weighted according function specified fn. fn fn object specifying weight function (default: fn(w ~ 1/n, c = TRUE) equal weights). Note: Weight functions support interactions () - pre-create needed transformed variables data. See fn details. RE Logical; TRUE, include random effects member-level units. Automatically set TRUE vars = NULL (random effects ). ar Logical; TRUE, random effects evolve autoregressively across participations. Requires members sequential participation indicators data. Default: FALSE.","code":""},{"path":"https://benrosche.github.io/bml/reference/mm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Define a multiple-membership structure — mm","text":"bml_mm object containing multiple-membership specification.","code":""},{"path":"https://benrosche.github.io/bml/reference/mm.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Define a multiple-membership structure — mm","text":"Multiple-Membership Models: standard hierarchical models, observation belongs exactly one group. Multiple-membership models relax assumption, allowing groups composed multiple members, flexible weighting member contributions. Model Structure: contribution mm block \\(k\\) group \\(j\\) : $$\\mathrm{mm}_{kj} = \\sum_{\\group_j} w_{ki} (x_{ki}' \\beta_k + \\alpha_{ki})$$ : \\(w_{ki}\\): Weight member \\(\\) group \\(j\\) (fn) \\(x_{ki}\\): Member-level covariates (vars) \\(\\beta_k\\): Regression coefficients (estimated) \\(\\alpha_{ki}\\): Member-level random effect (RE = TRUE) Multiple mm() Blocks: can specify multiple mm() blocks different weight functions, variables, random effect specifications. allows modeling different aggregation mechanisms simultaneously.","code":""},{"path":"https://benrosche.github.io/bml/reference/mm.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Define a multiple-membership structure — mm","text":"Rosche, B. (2026). Multilevel Model Theorizing Estimating Micro-Macro Link. Political Analysis. Browne, W. J., Goldstein, H., & Rasbash, J. (2001). Multiple membership multiple classification (MMMC) models. Statistical Modelling, 1(2), 103-124. Fielding, ., & Goldstein, H. (2006). Cross-classified multiple membership structures multilevel models: introduction review. Research Report RR791, Department Education Skills.","code":""},{"path":[]},{"path":"https://benrosche.github.io/bml/reference/mm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Define a multiple-membership structure — mm","text":"","code":"if (FALSE) { # \\dontrun{ # Equal weights with variables mm(   id = id(pid, gid),   vars = vars(rile + ipd),   fn = fn(w ~ 1/n, c = TRUE),   RE = FALSE )  # Random effects only (no variables) mm(   id = id(pid, gid),   vars = NULL,   fn = fn(w ~ 1/n, c = TRUE),   RE = TRUE  # Automatically TRUE when vars = NULL )  # Flexible weights with parameter mm(   id = id(pid, gid),   vars = vars(org_structure),   fn = fn(w ~ ilogit(b0 + b1 * pseat), c = TRUE),   RE = TRUE )  # Autoregressive random effects mm(   id = id(pid, gid),   vars = NULL,   fn = fn(w ~ 1/n, c = TRUE),   RE = TRUE,   ar = TRUE  # Random effects evolve over participations )  # Interactions and transformations in vars mm(   id = id(pid, gid),   vars = vars(rile * ipd),  # Main effects plus interaction   fn = fn(w ~ 1/n, c = TRUE),   RE = FALSE )  mm(   id = id(pid, gid),   vars = vars(rile + I(rile^2)),  # Quadratic term   fn = fn(w ~ 1/n, c = TRUE),   RE = FALSE ) } # }"},{"path":"https://benrosche.github.io/bml/reference/monetPlot.html","id":null,"dir":"Reference","previous_headings":"","what":"Visualize posterior distributions with density and trace plots — monetPlot","title":"Visualize posterior distributions with density and trace plots — monetPlot","text":"Creates combined diagnostic plot showing posterior density MCMC trace plot specified parameter. Helps assess convergence visualize posterior uncertainty. plot displays median 90% highest posterior density (HPD) interval.","code":""},{"path":"https://benrosche.github.io/bml/reference/monetPlot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Visualize posterior distributions with density and trace plots — monetPlot","text":"","code":"monetPlot(bml, parameter, label = NULL, r = 2, yaxis = T)"},{"path":"https://benrosche.github.io/bml/reference/monetPlot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Visualize posterior distributions with density and trace plots — monetPlot","text":"bml fitted model object class \"bml\" returned bml. Must fitted monitor = TRUE store MCMC chains. parameter Character string specifying parameter plot. Must use internal parameter name (.e., row names bml$reg.table). Examples: \"b[1]\" (intercept), \"b[2]\" (first covariate), \"b.mm.1\" (first mm block coefficient), \"sigma.mm\" (mm random effect SD). label Optional character string parameter label displayed plot. NULL (default), uses internal parameter name. r Number decimal places displayed quantiles statistics. Default: 2. yaxis Logical; TRUE (default), display axis titles (\"Density\" \"Scans\"). FALSE, omit axis titles cleaner appearance combining multiple plots.","code":""},{"path":"https://benrosche.github.io/bml/reference/monetPlot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Visualize posterior distributions with density and trace plots — monetPlot","text":"ggplot object (using patchwork) combining two panels: Top panel: Posterior density shaded 90% HPD interval.       Solid vertical line zero, dashed line posterior median. Bottom panel: Trace plot showing MCMC iterations across chains.       reference lines top panel. Helps diagnose convergence mixing.","code":""},{"path":"https://benrosche.github.io/bml/reference/monetPlot.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Visualize posterior distributions with density and trace plots — monetPlot","text":"Interpreting Plot: Density panel: Shows posterior distribution. dashed line     marks median (central estimate). Shading indicates 90% credible region. Trace panel: Shows parameter values across MCMC iterations     chain. Good mixing looks like \"fuzzy caterpillars\" chains overlapping.     Poor mixing shows trends, stickiness, separation chains. Convergence Checks: Chains overlap explore space sustained trends drift Rapid mixing (long autocorrelation) Use mcmcDiag formal convergence statistics (Gelman-Rubin, Geweke, etc.).","code":""},{"path":[]},{"path":"https://benrosche.github.io/bml/reference/monetPlot.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Visualize posterior distributions with density and trace plots — monetPlot","text":"Benjamin Rosche <benrosche@nyu.edu>","code":""},{"path":"https://benrosche.github.io/bml/reference/monetPlot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Visualize posterior distributions with density and trace plots — monetPlot","text":"","code":"if (FALSE) { # \\dontrun{ data(coalgov)  # Fit model with monitoring enabled m1 <- bml(   Surv(dur_wkb, event_wkb) ~ 1 + majority +     mm(id = id(pid, gid), vars = vars(cohesion), fn = fn(w ~ 1/n), RE = TRUE) +     hm(id = id(cid), type = \"RE\"),   family = \"Weibull\",   monitor = TRUE,  # Required for monetPlot   data = coalgov )  # Plot intercept monetPlot(m1, parameter = \"b[1]\", label = \"Intercept\")  # Plot majority coefficient with custom label monetPlot(m1, parameter = \"b[2]\", label = \"Majority Government Effect\")  # Plot mm coefficient monetPlot(m1, parameter = \"b.mm.1\", label = \"Party Fragmentation\")  # Plot random effect SD monetPlot(m1, parameter = \"sigma.mm.1\")  # List available parameters rownames(m1$reg.table) } # }"},{"path":"https://benrosche.github.io/bml/reference/schoolnets.html","id":null,"dir":"Reference","previous_headings":"","what":"CILS4EU — nodedat","title":"CILS4EU — nodedat","text":"... schoolid school identifier classid classroom identifier youthid student identifier sex etn parent_edu parent_inc test_lang test_cogn","code":""},{"path":"https://benrosche.github.io/bml/reference/schoolnets.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"CILS4EU — nodedat","text":"","code":"data(schoolnets)"},{"path":"https://benrosche.github.io/bml/reference/schoolnets.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"CILS4EU — nodedat","text":"... Col1 description Col1","code":""},{"path":"https://benrosche.github.io/bml/reference/schoolnets.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"CILS4EU — nodedat","text":"","code":"data(schoolnets)"},{"path":"https://benrosche.github.io/bml/reference/summary.bml.html","id":null,"dir":"Reference","previous_headings":"","what":"Summarize a fitted bml model — summary.bml","title":"Summarize a fitted bml model — summary.bml","text":"S3 method summarizing bml model objects. Returns formatted table parameter estimates posterior means, standard deviations, credible intervals, along model information convergence statistics.","code":""},{"path":"https://benrosche.github.io/bml/reference/summary.bml.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summarize a fitted bml model — summary.bml","text":"","code":"# S3 method for class 'bml' summary(object, r = 3, ...)"},{"path":"https://benrosche.github.io/bml/reference/summary.bml.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summarize a fitted bml model — summary.bml","text":"object fitted model object class \"bml\" returned bml. r Number decimal places rounding numeric output. Default: 3. ... Additional arguments (currently unused).","code":""},{"path":"https://benrosche.github.io/bml/reference/summary.bml.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summarize a fitted bml model — summary.bml","text":"data frame class \"bml_summary\" containing rounded parameter   estimates following columns: Parameter: Labeled parameter names mean: Posterior mean sd: Posterior standard deviation lb: Lower bound 95% credible interval ub: Upper bound 95% credible interval object includes metadata attributes printed table: Outcome family link function Estimate type (posterior mean MCMC) Credible interval specification (95% equal-tailed) Level specification (mm hm block details) DIC (Deviance Information Criterion) model comparison","code":""},{"path":"https://benrosche.github.io/bml/reference/summary.bml.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Summarize a fitted bml model — summary.bml","text":"summary method rounds numeric values readability preserving underlying structure metadata fitted model. columns remain accessible via standard data frame indexing (e.g., $Parameter, $mean). Cox models piecewise baseline hazards (cox_intervals specified), outcome description includes number intervals used.","code":""},{"path":[]},{"path":"https://benrosche.github.io/bml/reference/summary.bml.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Summarize a fitted bml model — summary.bml","text":"Benjamin Rosche <benrosche@nyu.edu>","code":""},{"path":"https://benrosche.github.io/bml/reference/summary.bml.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Summarize a fitted bml model — summary.bml","text":"","code":"if (FALSE) { # \\dontrun{ data(coalgov)  # Fit model m1 <- bml(   Surv(dur_wkb, event_wkb) ~ 1 + majority +     mm(id = id(pid, gid), vars = vars(cohesion), fn = fn(w ~ 1/n), RE = TRUE) +     hm(id = id(cid), type = \"RE\"),   family = \"Weibull\",   data = coalgov )  # View summary summary(m1)  # Summary with more decimal places summary(m1, r = 4)  # Access specific columns s <- summary(m1) s$Parameter  # Parameter names s$mean       # Posterior means s$lb         # Lower credible bounds  # Custom posterior summaries (requires monitor = TRUE) # Extract posterior draws as a tidy data frame draws <- coda::as.mcmc.list(m1$jags.out$BUGSoutput) |> as.matrix() |> as_tibble()  # Select specific parameters and compute custom summaries draws |>   dplyr::select(dplyr::starts_with(\"b[\")) |>   tidyr::pivot_longer(everything(), names_to = \"param\") |>   dplyr::group_by(param) |>   dplyr::summarise(     median = median(value),     mad    = mad(value),     q05    = quantile(value, 0.05),     q95    = quantile(value, 0.95)   ) } # }"},{"path":"https://benrosche.github.io/bml/reference/varDecomp.html","id":null,"dir":"Reference","previous_headings":"","what":"Variance decomposition for fitted bml models — varDecomp","title":"Variance decomposition for fitted bml models — varDecomp","text":"Computes posterior variance decomposition intraclass correlation coefficients (ICCs) fitted bml model. function automatically discovers variance components (sigma parameters) model, applies weight adjustments multiple-membership levels, returns posterior summaries.","code":""},{"path":"https://benrosche.github.io/bml/reference/varDecomp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Variance decomposition for fitted bml models — varDecomp","text":"","code":"varDecomp(model, uncertainty = \"sd\", r = 2)"},{"path":"https://benrosche.github.io/bml/reference/varDecomp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Variance decomposition for fitted bml models — varDecomp","text":"model fitted model object class \"bml\" returned bml. Must fitted monitor = TRUE (default). uncertainty Uncertainty measure report. One \"sd\" (posterior standard deviation, default), \"mad\" (median absolute deviation), \"ci\" (95% credible interval lower/upper bounds). r Number decimal places rounding numeric output. Default: 2.","code":""},{"path":"https://benrosche.github.io/bml/reference/varDecomp.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Variance decomposition for fitted bml models — varDecomp","text":"data frame class \"bml_varDecomp\" one row per variance   component. Always includes Component, sigma, ICC columns.   Additional columns depend uncertainty: \"sd\": sigma_sd ICC_sd \"mad\": sigma_mad ICC_mad \"ci\": sigma_lb, sigma_ub, ICC_lb, ICC_ub","code":""},{"path":"https://benrosche.github.io/bml/reference/varDecomp.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Variance decomposition for fitted bml models — varDecomp","text":"Variance decomposition. total variance outcome partitioned additive components, one level model: $$\\mathrm{Var}(y) = \\sigma_1^2 + \\sigma_2^2 + \\ldots$$ component contributes variance \\(\\sigma^2\\), except multiple-membership (MM) levels, effective variance contribution scaled average summed squared weights across groups. $$\\mathrm{Var}_{\\mathrm{mm}} = \\sigma_{\\mathrm{mm}}^2 \\cdot \\overline{w^2}, \\quad \\overline{w^2} = \\frac{1}{N} \\sum_{=1}^{N} \\sum_{k} w_{ik}^2$$ weight adjustment accounts fact member-level variance distributed across multiple members potentially unequal influence. equal weights (\\(w_{ik} = 1/n_i\\)), effective variance shrinks group size increases. Intraclass Correlation Coefficient (ICC). ICC given level proportion total variance attributable level: $$\\rho_l = \\frac{\\sigma_l^2}{\\sum_{l'} \\sigma_{l'}^2}$$ Intuitively, ICC answers: \"fraction total variation outcome due differences units level?\" ICC 0.30 country level, example, means 30% outcome variation can attributed -country differences. ICCs computed per posterior draw summarized, properly propagating uncertainty MCMC samples. Family-specific handling: Gaussian / Weibull: residual sigma model     used directly. Binomial: residual sigma. latent logistic     residual variance \\(\\pi^2/3 \\approx 3.29\\) used instead. Cox: residual variance. ICCs computed among     non-residual components .","code":""},{"path":[]},{"path":"https://benrosche.github.io/bml/reference/varDecomp.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Variance decomposition for fitted bml models — varDecomp","text":"Benjamin Rosche <benrosche@nyu.edu>","code":""},{"path":"https://benrosche.github.io/bml/reference/varDecomp.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Variance decomposition for fitted bml models — varDecomp","text":"","code":"if (FALSE) { # \\dontrun{ data(coalgov)  m1 <- bml(   Surv(dur_wkb, event_wkb) ~ 1 + majority +     mm(id = id(pid, gid), vars = vars(cohesion), fn = fn(w ~ 1/n), RE = TRUE) +     hm(id = id(cid), type = \"RE\"),   family = \"Weibull\",   data = coalgov )  varDecomp(m1) varDecomp(m1, uncertainty = \"ci\") varDecomp(m1, uncertainty = \"mad\") } # }"},{"path":"https://benrosche.github.io/bml/reference/vars.html","id":null,"dir":"Reference","previous_headings":"","what":"Specify covariates for multiple-membership or hierarchical models — vars","title":"Specify covariates for multiple-membership or hierarchical models — vars","text":"Helper function used within mm hm specify variables included level model. Supports free variables (coefficients estimated) fixed variables (coefficients held constant using fix).","code":""},{"path":"https://benrosche.github.io/bml/reference/vars.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Specify covariates for multiple-membership or hierarchical models — vars","text":"","code":"vars(...)"},{"path":"https://benrosche.github.io/bml/reference/vars.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Specify covariates for multiple-membership or hierarchical models — vars","text":"... Unquoted variable names data, combined using + (formula-style). Supports: Simple variables: vars(x + y) Interactions: vars(x * y) vars(x:y) Transformations: vars((x^2)) vars((x + y)) Fixed coefficients: vars(fix(x, 1.0) + y) Note: Numeric literals like 1, 0, -1 ignored (intercept support mm/hm blocks).","code":""},{"path":"https://benrosche.github.io/bml/reference/vars.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Specify covariates for multiple-membership or hierarchical models — vars","text":"bml_vars object containing: formula: Formula object use model.matrix() free: Character vector base variable names fixed: List variables fixed coefficients () Returns NULL variables specified.","code":""},{"path":[]},{"path":"https://benrosche.github.io/bml/reference/vars.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Specify covariates for multiple-membership or hierarchical models — vars","text":"","code":"if (FALSE) { # \\dontrun{ # Simple variable specification (formula-style with +) vars(income + education)  # Single variable vars(income)  # Interactions vars(income * education)  # expands to income + education + income:education vars(income:education)    # interaction only  # Transformations vars(I(income^2))         # squared term vars(income + I(income^2)) # linear and squared  # Mix free and fixed variables vars(fix(exposure, 1.0) + income + education)  # Use in mm() specification mm(   id = id(pid, gid),   vars = vars(rile + ipd),   fn = fn(w ~ 1/n),   RE = FALSE ) } # }"},{"path":[]},{"path":"https://benrosche.github.io/bml/news/index.html","id":"major-changes-0-9-0","dir":"Changelog","previous_headings":"","what":"Major Changes","title":"bml 0.9.0","text":"Package renamed rmm bml (Bayesian Multiple-Membership Multilevel Models) New syntax weight functions: ar parameter moved fn() specification mm() block level clearer API Old: fn(w ~ 1/n, c = TRUE, ar = FALSE) New: fn(w ~ 1/n, c = TRUE) ar = FALSE mm() level Support multiple mmid groups: package now supports models multiple membership identifiers, allowing complex membership structures Enhanced documentation: Comprehensive documentation added coalgov dataset including: Detailed variable descriptions organized level (identifiers, government-level, country-level, party-level) Statistical summaries variables Clear explanation multiple-membership structure Updated references examples","code":""},{"path":"https://benrosche.github.io/bml/news/index.html","id":"new-features-0-9-0","dir":"Changelog","previous_headings":"","what":"New Features","title":"bml 0.9.0","text":"Flexible weight function parameterization: Enhanced support parameterizing weight functions covariates group-specific structures Per-group random effects: Random effects can now specified separately different mmid groups Improved JAGS code generation: Optimized model string generation better performance complex multiple-membership structures","code":""},{"path":"https://benrosche.github.io/bml/news/index.html","id":"breaking-changes-0-9-0","dir":"Changelog","previous_headings":"","what":"Breaking Changes","title":"bml 0.9.0","text":"ar parameter moved: Existing code using fn(w ~ ..., ar = TRUE) must updated place ar mm() block instead Dataset changes: Removed schoolnets dataset (including nodedat edgedat objects) Updated coalgov dataset enhanced documentation additional variables","code":""},{"path":"https://benrosche.github.io/bml/news/index.html","id":"bug-fixes-0-9-0","dir":"Changelog","previous_headings":"","what":"Bug Fixes","title":"bml 0.9.0","text":"Fixed issues weight function constraints using multiple mm() blocks Improved handling group-level indices JAGS variable creation","code":""},{"path":"https://benrosche.github.io/bml/news/index.html","id":"documentation-0-9-0","dir":"Changelog","previous_headings":"","what":"Documentation","title":"bml 0.9.0","text":"Updated vignette examples use new syntax Added comprehensive FAQ section Improved installation instructions CRAN GitHub options Updated references reflect 2026 publication","code":""}]
