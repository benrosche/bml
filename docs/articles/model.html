<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Model Structure â€¢ bml</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><script src="../extra.js"></script><meta property="og:title" content="Model Structure">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">bml</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/bml.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Articles</h6></li>
    <li><a class="dropdown-item" href="../articles/installation.html">Installation</a></li>
    <li><a class="dropdown-item" href="../articles/model.html">Model Structure</a></li>
    <li><a class="dropdown-item" href="../articles/examples.html">Examples</a></li>
    <li><a class="dropdown-item" href="../articles/faq.html">Frequently Asked Questions</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/benrosche/bml/" aria-label="GitHub"><span class="fa fab fa-github"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Model Structure</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/benrosche/bml/blob/HEAD/vignettes/model.Rmd" class="external-link"><code>vignettes/model.Rmd</code></a></small>
      <div class="d-none name"><code>model.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>The <code>bml</code> package implements Bayesian
<strong>multiple-membership multilevel models (MMMM)</strong> with
<strong>parameterizable weight functions</strong>. These models are
designed for data structures where:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Lower-level units (members)</strong> can belong to
<strong>multiple higher-level units (groups)</strong>
</li>
<li>
<strong>Groups</strong> are composed of <strong>multiple
members</strong>
</li>
<li>Group outcomes depend on the combined influence of their constituent
members</li>
</ol>
<p>This structure is common across many empirical settings: political
parties participating in multiple coalition governments, individuals
participating in multiple teams, spatial units influenced by multiple
neighbors, or actors embedded in multiple networks.</p>
<p>The key innovation of the extended MMMM is that it allows researchers
to <strong>model rather than impose</strong> the aggregation mechanism
through which member-level effects combine to influence group-level
outcomes.</p>
</div>
<div class="section level2">
<h2 id="notation-and-data-structure">Notation and Data Structure<a class="anchor" aria-label="anchor" href="#notation-and-data-structure"></a>
</h2>
<p>Let:</p>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>â€¦</mi><mo>,</mo><mi>N</mi></mrow><annotation encoding="application/x-tex">i = 1, \ldots, N</annotation></semantics></math>
index <strong>groups</strong> (the primary unit of analysis)</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>â€¦</mi><mo>,</mo><mi>K</mi></mrow><annotation encoding="application/x-tex">k = 1, \ldots, K</annotation></semantics></math>
index <strong>members</strong> (lower-level units)</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>â€¦</mi><mo>,</mo><mi>J</mi></mrow><annotation encoding="application/x-tex">j = 1, \ldots, J</annotation></semantics></math>
index <strong>nesting units</strong> (higher-level contexts)</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false" form="prefix">[</mo><mi>i</mi><mo stretchy="false" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">p[i]</annotation></semantics></math>
denote the set of members belonging to group
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><mi>i</mi></msub><mo>=</mo><mo stretchy="false" form="prefix">|</mo><mi>p</mi><mo stretchy="false" form="prefix">[</mo><mi>i</mi><mo stretchy="false" form="postfix">]</mo><mo stretchy="false" form="prefix">|</mo></mrow><annotation encoding="application/x-tex">n_i = |p[i]|</annotation></semantics></math>
denote the number of members in group
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
</li>
</ul>
<p><strong>Example (Coalition Governments):</strong> Groups are
governments
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>),
members are political parties
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>),
and nesting units are countries
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>).
The function
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false" form="prefix">[</mo><mi>i</mi><mo stretchy="false" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">p[i]</annotation></semantics></math>
returns all parties in government
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>n</mi><mi>i</mi></msub><annotation encoding="application/x-tex">n_i</annotation></semantics></math>
is coalition size.</p>
<p>The outcome
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>y</mi><mi>i</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>g</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><annotation encoding="application/x-tex">y_i^{(g)}</annotation></semantics></math>
is measured at the group level, where superscript
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><mi>g</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(g)</annotation></semantics></math>
denotes the level of measurement. In what follows, we present the model
for Gaussian (normal) outcomes, though the framework extends to other
distributions (see Extensions section).</p>
</div>
<div class="section level2">
<h2 id="the-extended-multiple-membership-multilevel-model">The Extended Multiple-Membership Multilevel Model<a class="anchor" aria-label="anchor" href="#the-extended-multiple-membership-multilevel-model"></a>
</h2>
<div class="section level3">
<h3 id="full-model-specification">Full Model Specification<a class="anchor" aria-label="anchor" href="#full-model-specification"></a>
</h3>
<p>The extended MMMM decomposes a group-level outcome into three
components corresponding to the levels at which explanatory factors
operate:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>y</mi><mi>i</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>g</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><mo>=</mo><msubsup><mi>Î¸</mi><mi>i</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>g</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><mo>+</mo><msubsup><mi>Î¸</mi><mrow><mi>j</mi><mo stretchy="false" form="prefix">[</mo><mi>i</mi><mo stretchy="false" form="postfix">]</mo></mrow><mrow><mo stretchy="false" form="prefix">(</mo><mi>c</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><mo>+</mo><msubsup><mi>Î¸</mi><mi>i</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup></mrow><annotation encoding="application/x-tex">\begin{equation}
y_i^{(g)} = \theta_i^{(g)} + \theta_{j[i]}^{(c)} + \theta_i^{(p)} \tag{1}
\end{equation}</annotation></semantics></math></p>
<p>where:</p>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>Î¸</mi><mi>i</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>g</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><annotation encoding="application/x-tex">\theta_i^{(g)}</annotation></semantics></math>
is the <strong>group-level effect</strong>
</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>Î¸</mi><mrow><mi>j</mi><mo stretchy="false" form="prefix">[</mo><mi>i</mi><mo stretchy="false" form="postfix">]</mo></mrow><mrow><mo stretchy="false" form="prefix">(</mo><mi>c</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><annotation encoding="application/x-tex">\theta_{j[i]}^{(c)}</annotation></semantics></math>
is the <strong>nesting-level effect</strong> (for nesting unit
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>
containing group
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>)</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>Î¸</mi><mi>i</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><annotation encoding="application/x-tex">\theta_i^{(p)}</annotation></semantics></math>
is the <strong>aggregated member-level effect</strong>
</li>
</ul>
<p>Each component includes both systematic effects (observed covariates)
and random effects (unobserved heterogeneity).</p>
</div>
<div class="section level3">
<h3 id="group-level-effect">Group-Level Effect<a class="anchor" aria-label="anchor" href="#group-level-effect"></a>
</h3>
<p>The group-level effect models the direct influence of group-level
covariates and group-specific unobserved factors:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>Î¸</mi><mi>i</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>g</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><mo>=</mo><msup><mi>ğ›ƒ</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>g</mi><mo stretchy="false" form="postfix">)</mo></mrow></msup><mo>â‹…</mo><msubsup><mi>ğ±</mi><mi>i</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>g</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><mo>+</mo><msubsup><mi>u</mi><mi>i</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>g</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><mo>,</mo><mspace width="1.0em"></mspace><msubsup><mi>u</mi><mi>i</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>g</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><mover><mo>âˆ¼</mo><mtext mathvariant="normal">iid</mtext></mover><mi>N</mi><mo stretchy="false" form="prefix">(</mo><mn>0</mn><mo>,</mo><msubsup><mi>Ïƒ</mi><msup><mi>u</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>g</mi><mo stretchy="false" form="postfix">)</mo></mrow></msup><mn>2</mn></msubsup><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">\begin{equation}
\theta_i^{(g)} = \boldsymbol{\beta}^{(g)} \cdot \mathbf{x}_i^{(g)} + u_i^{(g)}, \quad u_i^{(g)} \overset{\text{iid}}{\sim} N(0, \sigma_{u^{(g)}}^2) \tag{2}
\end{equation}</annotation></semantics></math></p>
<p>where:</p>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>ğ±</mi><mi>i</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>g</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><mo>=</mo><mo stretchy="false" form="prefix">[</mo><mn>1</mn><mo>,</mo><msubsup><mi>x</mi><mrow><mn>1</mn><mi>i</mi></mrow><mrow><mo stretchy="false" form="prefix">(</mo><mi>g</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><mo>,</mo><mi>â€¦</mi><mo>,</mo><msubsup><mi>x</mi><mrow><mi>G</mi><mi>i</mi></mrow><mrow><mo stretchy="false" form="prefix">(</mo><mi>g</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><mo stretchy="false" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">\mathbf{x}_i^{(g)} = [1, x_{1i}^{(g)}, \ldots, x_{Gi}^{(g)}]</annotation></semantics></math>
is a vector of group-level covariates</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>ğ›ƒ</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>g</mi><mo stretchy="false" form="postfix">)</mo></mrow></msup><mo>=</mo><mo stretchy="false" form="prefix">[</mo><msubsup><mi>Î²</mi><mn>0</mn><mrow><mo stretchy="false" form="prefix">(</mo><mi>g</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><mo>,</mo><msubsup><mi>Î²</mi><mn>1</mn><mrow><mo stretchy="false" form="prefix">(</mo><mi>g</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><mo>,</mo><mi>â€¦</mi><mo>,</mo><msubsup><mi>Î²</mi><mi>G</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>g</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><mo stretchy="false" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">\boldsymbol{\beta}^{(g)} = [\beta_0^{(g)}, \beta_1^{(g)}, \ldots, \beta_G^{(g)}]</annotation></semantics></math>
are the corresponding regression coefficients</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>u</mi><mi>i</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>g</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><annotation encoding="application/x-tex">u_i^{(g)}</annotation></semantics></math>
are independently and identically distributed (i.i.d.) random
effects</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>Ïƒ</mi><msup><mi>u</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>g</mi><mo stretchy="false" form="postfix">)</mo></mrow></msup><mn>2</mn></msubsup><annotation encoding="application/x-tex">\sigma_{u^{(g)}}^2</annotation></semantics></math>
captures unobserved heterogeneity at the group level</li>
</ul>
<p><strong>Example:</strong> For government survival,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>ğ±</mi><mi>i</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>g</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><annotation encoding="application/x-tex">\mathbf{x}_i^{(g)}</annotation></semantics></math>
might include majority status, ideological heterogeneity, or economic
conditions.</p>
</div>
<div class="section level3">
<h3 id="nesting-level-effect">Nesting-Level Effect<a class="anchor" aria-label="anchor" href="#nesting-level-effect"></a>
</h3>
<p>When groups are nested within higher-level contexts, the
nesting-level effect accounts for hierarchical dependencies:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>Î¸</mi><mi>j</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>c</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><mo>=</mo><msup><mi>ğ›ƒ</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>c</mi><mo stretchy="false" form="postfix">)</mo></mrow></msup><mo>â‹…</mo><msubsup><mi>ğ±</mi><mi>j</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>c</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><mo>+</mo><msubsup><mi>u</mi><mi>j</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>c</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><mo>,</mo><mspace width="1.0em"></mspace><msubsup><mi>u</mi><mi>j</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>c</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><mover><mo>âˆ¼</mo><mtext mathvariant="normal">iid</mtext></mover><mi>N</mi><mo stretchy="false" form="prefix">(</mo><mn>0</mn><mo>,</mo><msubsup><mi>Ïƒ</mi><msup><mi>u</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>c</mi><mo stretchy="false" form="postfix">)</mo></mrow></msup><mn>2</mn></msubsup><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">\begin{equation}
\theta_j^{(c)} = \boldsymbol{\beta}^{(c)} \cdot \mathbf{x}_j^{(c)} + u_j^{(c)}, \quad u_j^{(c)} \overset{\text{iid}}{\sim} N(0, \sigma_{u^{(c)}}^2) \tag{3}
\end{equation}</annotation></semantics></math></p>
<p>where:</p>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>ğ±</mi><mi>j</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>c</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><mo>=</mo><mo stretchy="false" form="prefix">[</mo><msubsup><mi>x</mi><mrow><mn>1</mn><mi>j</mi></mrow><mrow><mo stretchy="false" form="prefix">(</mo><mi>c</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><mo>,</mo><mi>â€¦</mi><mo>,</mo><msubsup><mi>x</mi><mrow><mi>C</mi><mi>j</mi></mrow><mrow><mo stretchy="false" form="prefix">(</mo><mi>c</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><mo stretchy="false" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">\mathbf{x}_j^{(c)} = [x_{1j}^{(c)}, \ldots, x_{Cj}^{(c)}]</annotation></semantics></math>
are nesting-level covariates</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>ğ›ƒ</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>c</mi><mo stretchy="false" form="postfix">)</mo></mrow></msup><mo>=</mo><mo stretchy="false" form="prefix">[</mo><msubsup><mi>Î²</mi><mn>1</mn><mrow><mo stretchy="false" form="prefix">(</mo><mi>c</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><mo>,</mo><mi>â€¦</mi><mo>,</mo><msubsup><mi>Î²</mi><mi>C</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>c</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><mo stretchy="false" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">\boldsymbol{\beta}^{(c)} = [\beta_1^{(c)}, \ldots, \beta_C^{(c)}]</annotation></semantics></math>
are the corresponding coefficients</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>u</mi><mi>j</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>c</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><annotation encoding="application/x-tex">u_j^{(c)}</annotation></semantics></math>
are i.i.d. random effects</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>Ïƒ</mi><msup><mi>u</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>c</mi><mo stretchy="false" form="postfix">)</mo></mrow></msup><mn>2</mn></msubsup><annotation encoding="application/x-tex">\sigma_{u^{(c)}}^2</annotation></semantics></math>
captures unobserved heterogeneity at the nesting level</li>
</ul>
<p>Including
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>u</mi><mi>j</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>c</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><annotation encoding="application/x-tex">u_j^{(c)}</annotation></semantics></math>
allows groups within the same nesting unit to be more similar than
groups across nesting units, even after conditioning on observed
covariates.</p>
<p><strong>Example:</strong> Governments are nested within countries.
Country-level variables might include electoral system or investiture
requirements. The random effect captures country-specific factors
affecting all governments in that country.</p>
<p><strong>Note:</strong> Multiple <code><a href="../reference/hm.html">hm()</a></code> blocks can be
specified to accommodate cross-classified structures (e.g., groups
nested within multiple non-hierarchical contexts).</p>
</div>
<div class="section level3">
<h3 id="aggregated-member-level-effect">Aggregated Member-Level Effect<a class="anchor" aria-label="anchor" href="#aggregated-member-level-effect"></a>
</h3>
<p>The core innovation of the extended MMMM is modeling how member-level
effects aggregate to influence group outcomes. Individual member effects
are first specified, then aggregated via a weighted sum:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>Î¸</mi><mi>i</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><mo>=</mo><munder><mo>âˆ‘</mo><mrow><mi>k</mi><mo>âˆˆ</mo><mi>p</mi><mo stretchy="false" form="prefix">[</mo><mi>i</mi><mo stretchy="false" form="postfix">]</mo></mrow></munder><msub><mi>w</mi><mrow><mi>i</mi><mi>k</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>ğ›ƒ</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo stretchy="false" form="postfix">)</mo></mrow></msup><mo>â‹…</mo><msubsup><mi>ğ±</mi><mrow><mi>i</mi><mi>k</mi></mrow><mrow><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><mo>+</mo><msubsup><mi>u</mi><mi>k</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\begin{equation}
\theta_i^{(p)} = \sum_{k \in p[i]} w_{ik} \left( \boldsymbol{\beta}^{(p)} \cdot \mathbf{x}_{ik}^{(p)} + u_k^{(p)} \right) \tag{4}
\end{equation}</annotation></semantics></math></p>
<p>This can be decomposed into systematic and random components:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>Î¸</mi><mi>i</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><mo>=</mo><munder><munder><mrow><msup><mi>ğ›ƒ</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo stretchy="false" form="postfix">)</mo></mrow></msup><munder><mo>âˆ‘</mo><mrow><mi>k</mi><mo>âˆˆ</mo><mi>p</mi><mo stretchy="false" form="prefix">[</mo><mi>i</mi><mo stretchy="false" form="postfix">]</mo></mrow></munder><msub><mi>w</mi><mrow><mi>i</mi><mi>k</mi></mrow></msub><msubsup><mi>ğ±</mi><mrow><mi>i</mi><mi>k</mi></mrow><mrow><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup></mrow><mo accent="true">âŸ</mo></munder><mtext mathvariant="normal">Systematic component</mtext></munder><mo>+</mo><munder><munder><mrow><munder><mo>âˆ‘</mo><mrow><mi>k</mi><mo>âˆˆ</mo><mi>p</mi><mo stretchy="false" form="prefix">[</mo><mi>i</mi><mo stretchy="false" form="postfix">]</mo></mrow></munder><msub><mi>w</mi><mrow><mi>i</mi><mi>k</mi></mrow></msub><msubsup><mi>u</mi><mi>k</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup></mrow><mo accent="true">âŸ</mo></munder><mtext mathvariant="normal">Random component</mtext></munder><mo>,</mo><mspace width="1.0em"></mspace><msubsup><mi>u</mi><mi>k</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><mover><mo>âˆ¼</mo><mtext mathvariant="normal">iid</mtext></mover><mi>N</mi><mo stretchy="false" form="prefix">(</mo><mn>0</mn><mo>,</mo><msubsup><mi>Ïƒ</mi><msup><mi>u</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo stretchy="false" form="postfix">)</mo></mrow></msup><mn>2</mn></msubsup><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">\begin{equation}
\theta_i^{(p)} = \underbrace{\boldsymbol{\beta}^{(p)} \sum_{k \in p[i]} w_{ik} \mathbf{x}_{ik}^{(p)}}_{\text{Systematic component}} + \underbrace{\sum_{k \in p[i]} w_{ik} u_k^{(p)}}_{\text{Random component}}, \quad u_k^{(p)} \overset{\text{iid}}{\sim} N(0, \sigma_{u^{(p)}}^2) \tag{5}
\end{equation}</annotation></semantics></math></p>
<p>where:</p>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>ğ±</mi><mrow><mi>i</mi><mi>k</mi></mrow><mrow><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><mo>=</mo><mo stretchy="false" form="prefix">[</mo><msubsup><mi>x</mi><mrow><mn>1</mn><mi>i</mi><mi>k</mi></mrow><mrow><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><mo>,</mo><mi>â€¦</mi><mo>,</mo><msubsup><mi>x</mi><mrow><mi>P</mi><mi>i</mi><mi>k</mi></mrow><mrow><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><mo stretchy="false" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">\mathbf{x}_{ik}^{(p)} = [x_{1ik}^{(p)}, \ldots, x_{Pik}^{(p)}]</annotation></semantics></math>
are member-level covariates</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>ğ›ƒ</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo stretchy="false" form="postfix">)</mo></mrow></msup><mo>=</mo><mo stretchy="false" form="prefix">[</mo><msubsup><mi>Î²</mi><mn>1</mn><mrow><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><mo>,</mo><mi>â€¦</mi><mo>,</mo><msubsup><mi>Î²</mi><mi>P</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><mo stretchy="false" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">\boldsymbol{\beta}^{(p)} = [\beta_1^{(p)}, \ldots, \beta_P^{(p)}]</annotation></semantics></math>
are structural regression coefficients measuring the effect of member
attributes on group outcomes</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><mrow><mi>i</mi><mi>k</mi></mrow></msub><annotation encoding="application/x-tex">w_{ik}</annotation></semantics></math>
are <strong>aggregation weights</strong> determining how member
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>â€™s
contribution enters group
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>â€™s
outcome</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>u</mi><mi>k</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><annotation encoding="application/x-tex">u_k^{(p)}</annotation></semantics></math>
are i.i.d. member-specific random effects</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>Ïƒ</mi><msup><mi>u</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo stretchy="false" form="postfix">)</mo></mrow></msup><mn>2</mn></msubsup><annotation encoding="application/x-tex">\sigma_{u^{(p)}}^2</annotation></semantics></math>
captures unobserved heterogeneity at the member level</li>
</ul>
<p><strong>Interpretation of Weights:</strong> The weights
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><mrow><mi>i</mi><mi>k</mi></mrow></msub><annotation encoding="application/x-tex">w_{ik}</annotation></semantics></math>
define the <strong>micro-macro link</strong>â€”how individual member
characteristics combine to produce group-level outcomes. Since the
structural effect
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>ğ›ƒ</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo stretchy="false" form="postfix">)</mo></mrow></msup><annotation encoding="application/x-tex">\boldsymbol{\beta}^{(p)}</annotation></semantics></math>
is constant, the weights serve to aggregate the member-level covariate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>ğ±</mi><mrow><mi>i</mi><mi>k</mi></mrow><mrow><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><annotation encoding="application/x-tex">\mathbf{x}_{ik}^{(p)}</annotation></semantics></math>
into a group-level construct
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mo>âˆ‘</mo><mrow><mi>k</mi><mo>âˆˆ</mo><mi>p</mi><mo stretchy="false" form="prefix">[</mo><mi>i</mi><mo stretchy="false" form="postfix">]</mo></mrow></msub><msub><mi>w</mi><mrow><mi>i</mi><mi>k</mi></mrow></msub><msubsup><mi>ğ±</mi><mrow><mi>i</mi><mi>k</mi></mrow><mrow><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup></mrow><annotation encoding="application/x-tex">\sum_{k \in p[i]} w_{ik} \mathbf{x}_{ik}^{(p)}</annotation></semantics></math>.</p>
<p><strong>Covariance Structure:</strong> Including member-specific
random effects
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>u</mi><mi>k</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><annotation encoding="application/x-tex">u_k^{(p)}</annotation></semantics></math>
induces covariance among groups sharing members. The covariance between
groups
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>i</mi><mo>â€²</mo></msup><annotation encoding="application/x-tex">i'</annotation></semantics></math>
is:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Cov</mtext><mo stretchy="false" form="prefix">(</mo><msubsup><mi>y</mi><mi>i</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>g</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><mo>,</mo><msubsup><mi>y</mi><msup><mi>i</mi><mo>â€²</mo></msup><mrow><mo stretchy="false" form="prefix">(</mo><mi>g</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><mo stretchy="false" form="postfix">)</mo><mo>=</mo><msubsup><mi>Ïƒ</mi><msup><mi>u</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo stretchy="false" form="postfix">)</mo></mrow></msup><mn>2</mn></msubsup><munder><mo>âˆ‘</mo><mi>k</mi></munder><msub><mi>w</mi><mrow><mi>i</mi><mi>k</mi></mrow></msub><msub><mi>w</mi><mrow><msup><mi>i</mi><mo>â€²</mo></msup><mi>k</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\begin{equation}
\text{Cov}(y_i^{(g)}, y_{i'}^{(g)}) = \sigma_{u^{(p)}}^2 \sum_k w_{ik} w_{i'k}
\end{equation}</annotation></semantics></math></p>
<p>This increases with the degree of member overlap and accounts for
dependencies across groups involving recurring members.</p>
<p><strong>Example:</strong> In coalition governments,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>ğ±</mi><mrow><mi>i</mi><mi>k</mi></mrow><mrow><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><annotation encoding="application/x-tex">\mathbf{x}_{ik}^{(p)}</annotation></semantics></math>
might include party cohesion or organizational structure. The random
effect
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>u</mi><mi>k</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><annotation encoding="application/x-tex">u_k^{(p)}</annotation></semantics></math>
captures party-specific unobserved factors that affect all governments
in which party
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
participates.</p>
</div>
</div>
<div class="section level2">
<h2 id="parameterizable-weight-functions">Parameterizable Weight Functions<a class="anchor" aria-label="anchor" href="#parameterizable-weight-functions"></a>
</h2>
<div class="section level3">
<h3 id="conventional-mmmm-fixed-weights">Conventional MMMM: Fixed Weights<a class="anchor" aria-label="anchor" href="#conventional-mmmm-fixed-weights"></a>
</h3>
<p>The <strong>conventional MMMM</strong> requires weights to be
specified <em>a priori</em>. The most common choice is equal weighting
(arithmetic mean):</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mrow><mi>i</mi><mi>k</mi></mrow></msub><mo>=</mo><mfrac><mn>1</mn><msub><mi>n</mi><mi>i</mi></msub></mfrac></mrow><annotation encoding="application/x-tex">\begin{equation}
w_{ik} = \frac{1}{n_i} \tag{6}
\end{equation}</annotation></semantics></math></p>
<p>This assumes all members contribute equally to group outcomes,
regardless of their attributes or context.</p>
<p><strong>Limitations:</strong> Equal weighting is often theoretically
implausible. In coalition governments, for instance, larger parties,
parties holding the prime ministership, or ideologically central parties
may exert disproportionate influence. In spatial analysis, nearby
neighbors may matter more than distant ones. Imposing equal weights when
they vary in practice introduces <strong>aggregation bias</strong>.</p>
</div>
<div class="section level3">
<h3 id="extended-mmmm-endogenizing-weights">Extended MMMM: Endogenizing Weights<a class="anchor" aria-label="anchor" href="#extended-mmmm-endogenizing-weights"></a>
</h3>
<p>The <strong>extended MMMM</strong> allows weights to be modeled as
functions of covariates and estimated parameters:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mrow><mi>i</mi><mi>k</mi></mrow></msub><mo stretchy="false" form="prefix">(</mo><msubsup><mi>ğ±</mi><mrow><mi>i</mi><mi>k</mi></mrow><mrow><mo stretchy="false" form="prefix">(</mo><mi>w</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><mo>,</mo><msub><mi>n</mi><mi>i</mi></msub><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><mo stretchy="false" form="prefix">(</mo><msub><mi>n</mi><mi>i</mi></msub><mo>âˆ’</mo><mn>1</mn><mo stretchy="false" form="postfix">)</mo><mrow><mi mathvariant="normal">exp</mi><mo>â¡</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>âˆ’</mi><msup><mi>ğ›ƒ</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>w</mi><mo stretchy="false" form="postfix">)</mo></mrow></msup><mo>â‹…</mo><msubsup><mi>ğ±</mi><mrow><mi>i</mi><mi>k</mi></mrow><mrow><mo stretchy="false" form="prefix">(</mo><mi>w</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></mrow><annotation encoding="application/x-tex">\begin{equation}
w_{ik}(\mathbf{x}_{ik}^{(w)}, n_i) = \frac{1}{1 + (n_i - 1) \exp\left(-\boldsymbol{\beta}^{(w)} \cdot \mathbf{x}_{ik}^{(w)}\right)} \tag{7}
\end{equation}</annotation></semantics></math></p>
<p>subject to the normalization constraint
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mo>âˆ‘</mo><mrow><mi>k</mi><mo>âˆˆ</mo><mi>p</mi><mo stretchy="false" form="prefix">[</mo><mi>i</mi><mo stretchy="false" form="postfix">]</mo></mrow></msub><msub><mi>w</mi><mrow><mi>i</mi><mi>k</mi></mrow></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\sum_{k \in p[i]} w_{ik} = 1</annotation></semantics></math>
for all
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>.</p>
<p>where:</p>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>ğ±</mi><mrow><mi>i</mi><mi>k</mi></mrow><mrow><mo stretchy="false" form="prefix">(</mo><mi>w</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><mo>=</mo><mo stretchy="false" form="prefix">[</mo><mn>1</mn><mo>,</mo><msubsup><mi>x</mi><mrow><mn>1</mn><mi>i</mi><mi>k</mi></mrow><mrow><mo stretchy="false" form="prefix">(</mo><mi>w</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><mo>,</mo><mi>â€¦</mi><mo>,</mo><msubsup><mi>x</mi><mrow><mi>W</mi><mi>i</mi><mi>k</mi></mrow><mrow><mo stretchy="false" form="prefix">(</mo><mi>w</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><mo stretchy="false" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">\mathbf{x}_{ik}^{(w)} = [1, x_{1ik}^{(w)}, \ldots, x_{Wik}^{(w)}]</annotation></semantics></math>
are <strong>weight covariates</strong>
</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>ğ›ƒ</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>w</mi><mo stretchy="false" form="postfix">)</mo></mrow></msup><mo>=</mo><mo stretchy="false" form="prefix">[</mo><msubsup><mi>Î²</mi><mn>0</mn><mrow><mo stretchy="false" form="prefix">(</mo><mi>w</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><mo>,</mo><msubsup><mi>Î²</mi><mn>1</mn><mrow><mo stretchy="false" form="prefix">(</mo><mi>w</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><mo>,</mo><mi>â€¦</mi><mo>,</mo><msubsup><mi>Î²</mi><mi>W</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>w</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><mo stretchy="false" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">\boldsymbol{\beta}^{(w)} = [\beta_0^{(w)}, \beta_1^{(w)}, \ldots, \beta_W^{(w)}]</annotation></semantics></math>
are <strong>weight function parameters</strong> to be estimated</li>
</ul>
<p><strong>Functional Form:</strong> Equation (7) generalizes the
logistic function by centering it at
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mi>/</mi><msub><mi>n</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">1/n_i</annotation></semantics></math>
when
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>ğ›ƒ</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>w</mi><mo stretchy="false" form="postfix">)</mo></mrow></msup><mo>â‹…</mo><msubsup><mi>ğ±</mi><mrow><mi>i</mi><mi>k</mi></mrow><mrow><mo stretchy="false" form="prefix">(</mo><mi>w</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\boldsymbol{\beta}^{(w)} \cdot \mathbf{x}_{ik}^{(w)} = 0</annotation></semantics></math>.
This sets equal weighting as the baseline: absent systematic
differences, each member receives weight
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mi>/</mi><msub><mi>n</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">1/n_i</annotation></semantics></math>.
When
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>ğ›ƒ</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>w</mi><mo stretchy="false" form="postfix">)</mo></mrow></msup><mo>â‰ </mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\boldsymbol{\beta}^{(w)} \neq 0</annotation></semantics></math>,
weights deviate from this baseline, reflecting heterogeneous member
influence.</p>
<p><strong>Properties:</strong></p>
<ul>
<li>Bounded:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mrow><mi>i</mi><mi>k</mi></mrow></msub><mo>âˆˆ</mo><mo stretchy="false" form="prefix">[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">w_{ik} \in [0, 1]</annotation></semantics></math>
</li>
<li>Baseline-centered: When
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>ğ›ƒ</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>w</mi><mo stretchy="false" form="postfix">)</mo></mrow></msup><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\boldsymbol{\beta}^{(w)} = 0</annotation></semantics></math>,
weights reduce to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mrow><mi>i</mi><mi>k</mi></mrow></msub><mo>=</mo><mn>1</mn><mi>/</mi><msub><mi>n</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">w_{ik} = 1/n_i</annotation></semantics></math>
</li>
<li>Monotonic: Weights increase/decrease smoothly with the linear
predictor</li>
<li>Normalized: Constraint ensures
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mo>âˆ‘</mo><mi>k</mi></msub><msub><mi>w</mi><mrow><mi>i</mi><mi>k</mi></mrow></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\sum_k w_{ik} = 1</annotation></semantics></math>
(unless normalization is disabled)</li>
</ul>
<p><strong>Interpretation of Weight Parameters:</strong> While
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>ğ›ƒ</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo stretchy="false" form="postfix">)</mo></mrow></msup><annotation encoding="application/x-tex">\boldsymbol{\beta}^{(p)}</annotation></semantics></math>
measure <em>structural effects</em> of member attributes on group
outcomes,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>ğ›ƒ</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>w</mi><mo stretchy="false" form="postfix">)</mo></mrow></msup><annotation encoding="application/x-tex">\boldsymbol{\beta}^{(w)}</annotation></semantics></math>
measure <em>aggregation effects</em>â€”how member attributes determine
their relative importance in the weighted sum. Together, they reveal
both <em>what</em> matters (structural effects) and <em>how much</em>
different membersâ€™ characteristics matter (aggregation effects).</p>
<p><strong>Example:</strong> Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>x</mi><mrow><mi>i</mi><mi>k</mi></mrow><mrow><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><annotation encoding="application/x-tex">x_{ik}^{(p)}</annotation></semantics></math>
= party cohesion and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>x</mi><mrow><mi>i</mi><mi>k</mi></mrow><mrow><mo stretchy="false" form="prefix">(</mo><mi>w</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><annotation encoding="application/x-tex">x_{ik}^{(w)}</annotation></semantics></math>
= indicator for holding the prime ministership in a government survival
model.</p>
<ul>
<li>If
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>Î²</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>w</mi><mo stretchy="false" form="postfix">)</mo></mrow></msup><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\beta^{(w)} = 0</annotation></semantics></math>:
Prime ministerâ€™s cohesion matters as much as coalition partnersâ€™
cohesion (equal weights)</li>
<li>If
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>Î²</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>w</mi><mo stretchy="false" form="postfix">)</mo></mrow></msup><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\beta^{(w)} &gt; 0</annotation></semantics></math>:
Prime ministerâ€™s cohesion carries more weight</li>
<li>If
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>Î²</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>w</mi><mo stretchy="false" form="postfix">)</mo></mrow></msup><mo>&lt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\beta^{(w)} &lt; 0</annotation></semantics></math>:
Coalition partnersâ€™ cohesion carries more weight</li>
</ul>
</div>
<div class="section level3">
<h3 id="testing-alternative-aggregation-mechanisms">Testing Alternative Aggregation Mechanisms<a class="anchor" aria-label="anchor" href="#testing-alternative-aggregation-mechanisms"></a>
</h3>
<p>Weight function regression enables empirical tests of substantive
hypotheses about aggregation:</p>
<p><strong>1. Mean vs.Â Extremes:</strong> Does the group outcome depend
on the average member attribute or on extreme values
(minimum/maximum)?</p>
<p>Create indicator variables for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="normal">argmin</mtext><mi>k</mi></msub><mo stretchy="false" form="prefix">(</mo><msubsup><mi>x</mi><mrow><mi>i</mi><mi>k</mi></mrow><mrow><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">\text{argmin}_k(x_{ik}^{(p)})</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="normal">argmax</mtext><mi>k</mi></msub><mo stretchy="false" form="prefix">(</mo><msubsup><mi>x</mi><mrow><mi>i</mi><mi>k</mi></mrow><mrow><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">\text{argmax}_k(x_{ik}^{(p)})</annotation></semantics></math>
and include them in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>ğ±</mi><mrow><mi>i</mi><mi>k</mi></mrow><mrow><mo stretchy="false" form="prefix">(</mo><mi>w</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><annotation encoding="application/x-tex">\mathbf{x}_{ik}^{(w)}</annotation></semantics></math>.
If aggregation is better captured by extremes, the corresponding
memberâ€™s weight will approach 1.</p>
<p><strong>2. Mean vs.Â Sum:</strong> Are member effects
<em>contextual</em> (mean aggregation:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mo>âˆ‘</mo><mi>k</mi></msub><msub><mi>w</mi><mrow><mi>i</mi><mi>k</mi></mrow></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\sum_k w_{ik} = 1</annotation></semantics></math>)
or <em>autonomous</em> (sum aggregation:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mo>âˆ‘</mo><mi>k</mi></msub><msub><mi>w</mi><mrow><mi>i</mi><mi>k</mi></mrow></msub><mo>=</mo><msub><mi>n</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\sum_k w_{ik} = n_i</annotation></semantics></math>)?</p>
<p>Disable normalization (<code>c = FALSE</code> in <code><a href="../reference/fn.html">fn()</a></code>).
The intercept
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>Î²</mi><mn>0</mn><mrow><mo stretchy="false" form="prefix">(</mo><mi>w</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><annotation encoding="application/x-tex">\beta_0^{(w)}</annotation></semantics></math>
then reveals the aggregation form: -
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>Î²</mi><mn>0</mn><mrow><mo stretchy="false" form="prefix">(</mo><mi>w</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><mo>â‰ˆ</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\beta_0^{(w)} \approx 0</annotation></semantics></math>:
Mean aggregation -
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>Î²</mi><mn>0</mn><mrow><mo stretchy="false" form="prefix">(</mo><mi>w</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><mo>â‰«</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\beta_0^{(w)} \gg 0</annotation></semantics></math>:
Sum aggregation</p>
<p>Under mean aggregation, a one-unit change in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>x</mi><mrow><mi>i</mi><mi>k</mi></mrow><mrow><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><annotation encoding="application/x-tex">x_{ik}^{(p)}</annotation></semantics></math>
affects the outcome by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>Î²</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo stretchy="false" form="postfix">)</mo></mrow></msup><annotation encoding="application/x-tex">\beta^{(p)}</annotation></semantics></math>
only if <em>all</em> members change. Under sum aggregation, a one-unit
change by a <em>single</em> member already produces an effect of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>Î²</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo stretchy="false" form="postfix">)</mo></mrow></msup><annotation encoding="application/x-tex">\beta^{(p)}</annotation></semantics></math>.</p>
<p><strong>3. Asymmetric Influence:</strong> Do certain members (e.g.,
larger, more central, more powerful) carry disproportionate weight?</p>
<p>Include member attributes hypothesized to determine influence (e.g.,
size, centrality, power) in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>ğ±</mi><mrow><mi>i</mi><mi>k</mi></mrow><mrow><mo stretchy="false" form="prefix">(</mo><mi>w</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><annotation encoding="application/x-tex">\mathbf{x}_{ik}^{(w)}</annotation></semantics></math>.</p>
</div>
</div>
<div class="section level2">
<h2 id="variance-decomposition-and-intraclass-correlation">Variance Decomposition and Intraclass Correlation<a class="anchor" aria-label="anchor" href="#variance-decomposition-and-intraclass-correlation"></a>
</h2>
<p>The multilevel structure partitions total variance into group-level,
nesting-level, and member-level components:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Var</mtext><mo stretchy="false" form="prefix">(</mo><msubsup><mi>y</mi><mi>i</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>g</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><mo stretchy="false" form="postfix">)</mo><mo>=</mo><msubsup><mi>Ïƒ</mi><msup><mi>u</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>g</mi><mo stretchy="false" form="postfix">)</mo></mrow></msup><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>Ïƒ</mi><msup><mi>u</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>c</mi><mo stretchy="false" form="postfix">)</mo></mrow></msup><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>Ïƒ</mi><msup><mi>u</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo stretchy="false" form="postfix">)</mo></mrow></msup><mn>2</mn></msubsup><munder><mo>âˆ‘</mo><mrow><mi>k</mi><mo>âˆˆ</mo><mi>p</mi><mo stretchy="false" form="prefix">[</mo><mi>i</mi><mo stretchy="false" form="postfix">]</mo></mrow></munder><msubsup><mi>w</mi><mrow><mi>i</mi><mi>k</mi></mrow><mn>2</mn></msubsup></mrow><annotation encoding="application/x-tex">\begin{equation}
\text{Var}(y_i^{(g)}) = \sigma_{u^{(g)}}^2 + \sigma_{u^{(c)}}^2 + \sigma_{u^{(p)}}^2 \sum_{k \in p[i]} w_{ik}^2
\end{equation}</annotation></semantics></math></p>
<p><strong>Intraclass Correlation Coefficients (ICC):</strong></p>
<p>The proportion of variance attributable to each level quantifies the
importance of group-level, nesting-level, and member-level unobserved
factors:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right; padding-right: 0"><msup><mi>Ï</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>g</mi><mo stretchy="false" form="postfix">)</mo></mrow></msup></mtd><mtd columnalign="left" style="text-align: left; padding-left: 0"><mo>=</mo><mfrac><msubsup><mi>Ïƒ</mi><msup><mi>u</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>g</mi><mo stretchy="false" form="postfix">)</mo></mrow></msup><mn>2</mn></msubsup><mrow><msubsup><mi>Ïƒ</mi><msup><mi>u</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>g</mi><mo stretchy="false" form="postfix">)</mo></mrow></msup><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>Ïƒ</mi><msup><mi>u</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>c</mi><mo stretchy="false" form="postfix">)</mo></mrow></msup><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>Ïƒ</mi><msup><mi>u</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo stretchy="false" form="postfix">)</mo></mrow></msup><mn>2</mn></msubsup><mi>ğ”¼</mi><mo stretchy="false" form="prefix">[</mo><munder><mo>âˆ‘</mo><mi>k</mi></munder><msubsup><mi>w</mi><mrow><mi>i</mi><mi>k</mi></mrow><mn>2</mn></msubsup><mo stretchy="false" form="postfix">]</mo></mrow></mfrac></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right; padding-right: 0"><msup><mi>Ï</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>c</mi><mo stretchy="false" form="postfix">)</mo></mrow></msup></mtd><mtd columnalign="left" style="text-align: left; padding-left: 0"><mo>=</mo><mfrac><msubsup><mi>Ïƒ</mi><msup><mi>u</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>c</mi><mo stretchy="false" form="postfix">)</mo></mrow></msup><mn>2</mn></msubsup><mrow><msubsup><mi>Ïƒ</mi><msup><mi>u</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>g</mi><mo stretchy="false" form="postfix">)</mo></mrow></msup><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>Ïƒ</mi><msup><mi>u</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>c</mi><mo stretchy="false" form="postfix">)</mo></mrow></msup><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>Ïƒ</mi><msup><mi>u</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo stretchy="false" form="postfix">)</mo></mrow></msup><mn>2</mn></msubsup><mi>ğ”¼</mi><mo stretchy="false" form="prefix">[</mo><munder><mo>âˆ‘</mo><mi>k</mi></munder><msubsup><mi>w</mi><mrow><mi>i</mi><mi>k</mi></mrow><mn>2</mn></msubsup><mo stretchy="false" form="postfix">]</mo></mrow></mfrac></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right; padding-right: 0"><msup><mi>Ï</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo stretchy="false" form="postfix">)</mo></mrow></msup></mtd><mtd columnalign="left" style="text-align: left; padding-left: 0"><mo>=</mo><mfrac><mrow><msubsup><mi>Ïƒ</mi><msup><mi>u</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo stretchy="false" form="postfix">)</mo></mrow></msup><mn>2</mn></msubsup><mi>ğ”¼</mi><mo stretchy="false" form="prefix">[</mo><munder><mo>âˆ‘</mo><mi>k</mi></munder><msubsup><mi>w</mi><mrow><mi>i</mi><mi>k</mi></mrow><mn>2</mn></msubsup><mo stretchy="false" form="postfix">]</mo></mrow><mrow><msubsup><mi>Ïƒ</mi><msup><mi>u</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>g</mi><mo stretchy="false" form="postfix">)</mo></mrow></msup><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>Ïƒ</mi><msup><mi>u</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>c</mi><mo stretchy="false" form="postfix">)</mo></mrow></msup><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>Ïƒ</mi><msup><mi>u</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo stretchy="false" form="postfix">)</mo></mrow></msup><mn>2</mn></msubsup><mi>ğ”¼</mi><mo stretchy="false" form="prefix">[</mo><munder><mo>âˆ‘</mo><mi>k</mi></munder><msubsup><mi>w</mi><mrow><mi>i</mi><mi>k</mi></mrow><mn>2</mn></msubsup><mo stretchy="false" form="postfix">]</mo></mrow></mfrac></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align}
\rho^{(g)} &amp;= \frac{\sigma_{u^{(g)}}^2}{\sigma_{u^{(g)}}^2 + \sigma_{u^{(c)}}^2 + \sigma_{u^{(p)}}^2 \mathbb{E}[\sum_k w_{ik}^2]} \\
\rho^{(c)} &amp;= \frac{\sigma_{u^{(c)}}^2}{\sigma_{u^{(g)}}^2 + \sigma_{u^{(c)}}^2 + \sigma_{u^{(p)}}^2 \mathbb{E}[\sum_k w_{ik}^2]} \\
\rho^{(p)} &amp;= \frac{\sigma_{u^{(p)}}^2 \mathbb{E}[\sum_k w_{ik}^2]}{\sigma_{u^{(g)}}^2 + \sigma_{u^{(c)}}^2 + \sigma_{u^{(p)}}^2 \mathbb{E}[\sum_k w_{ik}^2]}
\end{align}</annotation></semantics></math></p>
<p>When weights are equal
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mrow><mi>i</mi><mi>k</mi></mrow></msub><mo>=</mo><mn>1</mn><mi>/</mi><msub><mi>n</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">w_{ik} = 1/n_i</annotation></semantics></math>),
the member-level variance component simplifies to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>Ïƒ</mi><msup><mi>u</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo stretchy="false" form="postfix">)</mo></mrow></msup><mn>2</mn></msubsup><mi>/</mi><mover><mi>n</mi><mo accent="true">â€¾</mo></mover></mrow><annotation encoding="application/x-tex">\sigma_{u^{(p)}}^2 / \bar{n}</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>n</mi><mo accent="true">â€¾</mo></mover><annotation encoding="application/x-tex">\bar{n}</annotation></semantics></math>
is average group size.</p>
</div>
<div class="section level2">
<h2 id="extensions">Extensions<a class="anchor" aria-label="anchor" href="#extensions"></a>
</h2>
<div class="section level3">
<h3 id="multiple-mm-blocks">Multiple MM Blocks<a class="anchor" aria-label="anchor" href="#multiple-mm-blocks"></a>
</h3>
<p>The <code>bml</code> package allows multiple <code><a href="../reference/mm.html">mm()</a></code> blocks
with distinct aggregation mechanisms. This is useful when different
member-level covariates aggregate through different processes:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>Î¸</mi><mi>i</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><mo>=</mo><munderover><mo>âˆ‘</mo><mrow><mi>b</mi><mo>=</mo><mn>1</mn></mrow><mi>B</mi></munderover><munder><mo>âˆ‘</mo><mrow><mi>k</mi><mo>âˆˆ</mo><mi>p</mi><mo stretchy="false" form="prefix">[</mo><mi>i</mi><mo stretchy="false" form="postfix">]</mo></mrow></munder><msubsup><mi>w</mi><mrow><mi>i</mi><mi>k</mi></mrow><mrow><mo stretchy="false" form="prefix">(</mo><mi>b</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>ğ›ƒ</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo>,</mo><mi>b</mi><mo stretchy="false" form="postfix">)</mo></mrow></msup><mo>â‹…</mo><msubsup><mi>ğ±</mi><mrow><mi>i</mi><mi>k</mi></mrow><mrow><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo>,</mo><mi>b</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><mo>+</mo><msubsup><mi>u</mi><mi>k</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo>,</mo><mi>b</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\begin{equation}
\theta_i^{(p)} = \sum_{b=1}^B \sum_{k \in p[i]} w_{ik}^{(b)} \left( \boldsymbol{\beta}^{(p,b)} \cdot \mathbf{x}_{ik}^{(p,b)} + u_k^{(p,b)} \right)
\end{equation}</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>b</mi><annotation encoding="application/x-tex">b</annotation></semantics></math>
indexes MM blocks, each with its own weight function
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>w</mi><mrow><mi>i</mi><mi>k</mi></mrow><mrow><mo stretchy="false" form="prefix">(</mo><mi>b</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><mo>=</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><msubsup><mi>ğ±</mi><mrow><mi>i</mi><mi>k</mi></mrow><mrow><mo stretchy="false" form="prefix">(</mo><mi>w</mi><mo>,</mo><mi>b</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><mo>,</mo><msub><mi>n</mi><mi>i</mi></msub><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">w_{ik}^{(b)} = f(\mathbf{x}_{ik}^{(w,b)}, n_i)</annotation></semantics></math>.</p>
<p><strong>Example:</strong> Model both observed party characteristics
(with estimated weights) and party random effects (with equal
weights):</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/mm.html">mm</a></span><span class="op">(</span>id <span class="op">=</span> <span class="fu"><a href="../reference/id.html">id</a></span><span class="op">(</span><span class="va">pid</span>, <span class="va">gid</span><span class="op">)</span>, vars <span class="op">=</span> <span class="fu"><a href="../reference/vars.html">vars</a></span><span class="op">(</span><span class="va">cohesion</span><span class="op">)</span>, fn <span class="op">=</span> <span class="fu"><a href="../reference/fn.html">fn</a></span><span class="op">(</span><span class="va">w</span> <span class="op">~</span> <span class="fl">1</span><span class="op">/</span><span class="va">n</span><span class="op">^</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">b</span><span class="op">*</span><span class="va">primeminister</span><span class="op">)</span><span class="op">)</span>, RE <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu"><a href="../reference/mm.html">mm</a></span><span class="op">(</span>id <span class="op">=</span> <span class="fu"><a href="../reference/id.html">id</a></span><span class="op">(</span><span class="va">pid</span>, <span class="va">gid</span><span class="op">)</span>, vars <span class="op">=</span> <span class="cn">NULL</span>, fn <span class="op">=</span> <span class="fu"><a href="../reference/fn.html">fn</a></span><span class="op">(</span><span class="va">w</span> <span class="op">~</span> <span class="fl">1</span><span class="op">/</span><span class="va">n</span><span class="op">)</span>, RE <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><strong>Important:</strong> Only one <code><a href="../reference/mm.html">mm()</a></code> block can have
<code>RE = TRUE</code> in a given model.</p>
</div>
<div class="section level3">
<h3 id="autoregressive-random-effects">Autoregressive Random Effects<a class="anchor" aria-label="anchor" href="#autoregressive-random-effects"></a>
</h3>
<p>Member random effects may evolve over time rather than remain
constant. The <code>ar = TRUE</code> option specifies a random walk
process:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>u</mi><mrow><mi>i</mi><mi>k</mi></mrow><mrow><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><mo>âˆ¼</mo><mrow><mo stretchy="true" form="prefix">{</mo><mtable><mtr><mtd columnalign="left" style="text-align: left"><mi>N</mi><mo stretchy="false" form="prefix">(</mo><mn>0</mn><mo>,</mo><msubsup><mi>Ïƒ</mi><msup><mi>u</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo stretchy="false" form="postfix">)</mo></mrow></msup><mn>2</mn></msubsup><mo stretchy="false" form="postfix">)</mo></mtd><mtd columnalign="left" style="text-align: left"><mrow><mtext mathvariant="normal">if </mtext><mspace width="0.333em"></mspace></mrow><mi>g</mi><mo stretchy="false" form="prefix">[</mo><mi>i</mi><mo>,</mo><mi>k</mi><mo stretchy="false" form="postfix">]</mo><mo>=</mo><mi>âˆ…</mi></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><mi>N</mi><mo stretchy="false" form="prefix">(</mo><msubsup><mi>u</mi><mrow><mi>g</mi><mo stretchy="false" form="prefix">[</mo><mi>i</mi><mo>,</mo><mi>k</mi><mo stretchy="false" form="postfix">]</mo><mo>,</mo><mi>k</mi></mrow><mrow><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><mo>,</mo><msubsup><mi>Ïƒ</mi><msup><mi>u</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo stretchy="false" form="postfix">)</mo></mrow></msup><mn>2</mn></msubsup><mo stretchy="false" form="postfix">)</mo></mtd><mtd columnalign="left" style="text-align: left"><mrow><mtext mathvariant="normal">if </mtext><mspace width="0.333em"></mspace></mrow><mi>g</mi><mo stretchy="false" form="prefix">[</mo><mi>i</mi><mo>,</mo><mi>k</mi><mo stretchy="false" form="postfix">]</mo><mo>â‰ </mo><mi>âˆ…</mi></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">\begin{equation}
u_{ik}^{(p)} \sim \begin{cases}
N(0, \sigma_{u^{(p)}}^2) &amp; \text{if } g[i,k] = \emptyset \\
N(u_{g[i,k],k}^{(p)}, \sigma_{u^{(p)}}^2) &amp; \text{if } g[i,k] \neq \emptyset
\end{cases}
\end{equation}</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mo stretchy="false" form="prefix">[</mo><mi>i</mi><mo>,</mo><mi>k</mi><mo stretchy="false" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">g[i,k]</annotation></semantics></math>
returns the most recent previous group in which member
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
participated. For
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mo stretchy="false" form="prefix">[</mo><mi>i</mi><mo>,</mo><mi>k</mi><mo stretchy="false" form="postfix">]</mo><mo>=</mo><mi>âˆ…</mi></mrow><annotation encoding="application/x-tex">g[i,k] = \emptyset</annotation></semantics></math>
(first participation), the effect is drawn from the prior.</p>
<p><strong>Interpretation:</strong> Autoregressive effects capture
dynamics where a memberâ€™s unobserved heterogeneity changes across
successive group participations. The variance
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>Ïƒ</mi><msup><mi>u</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo stretchy="false" form="postfix">)</mo></mrow></msup><mn>2</mn></msubsup><annotation encoding="application/x-tex">\sigma_{u^{(p)}}^2</annotation></semantics></math>
now represents the <em>innovation variance</em> governing temporal
change.</p>
<p><strong>Example:</strong> A partyâ€™s propensity to destabilize
governments may evolve as its leadership, organization, or electoral
fortunes change.</p>
<p><strong>Usage:</strong></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/mm.html">mm</a></span><span class="op">(</span>id <span class="op">=</span> <span class="fu"><a href="../reference/id.html">id</a></span><span class="op">(</span><span class="va">pid</span>, <span class="va">gid</span><span class="op">)</span>, vars <span class="op">=</span> <span class="fu"><a href="../reference/vars.html">vars</a></span><span class="op">(</span><span class="va">cohesion</span><span class="op">)</span>, fn <span class="op">=</span> <span class="fu"><a href="../reference/fn.html">fn</a></span><span class="op">(</span><span class="va">w</span> <span class="op">~</span> <span class="fl">1</span><span class="op">/</span><span class="va">n</span><span class="op">)</span>, RE <span class="op">=</span> <span class="cn">TRUE</span>, ar <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="opposition-members">Opposition Members<a class="anchor" aria-label="anchor" href="#opposition-members"></a>
</h3>
<p>When analyzing group outcomes influenced by both members and
non-members (e.g., coalition and opposition parties), separate
<code><a href="../reference/mm.html">mm()</a></code> blocks can model their distinct contributions:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>Î¸</mi><mi>i</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><mo>=</mo><munder><mo>âˆ‘</mo><mrow><mi>k</mi><mo>âˆˆ</mo><mi>p</mi><mo stretchy="false" form="prefix">[</mo><mi>i</mi><mo stretchy="false" form="postfix">]</mo></mrow></munder><msubsup><mi>w</mi><mrow><mi>i</mi><mi>k</mi></mrow><mrow><mo stretchy="false" form="prefix">(</mo><mi>g</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>ğ›ƒ</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>g</mi><mo stretchy="false" form="postfix">)</mo></mrow></msup><mo>â‹…</mo><msubsup><mi>ğ±</mi><mrow><mi>i</mi><mi>k</mi></mrow><mrow><mo stretchy="false" form="prefix">(</mo><mi>g</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><mo>+</mo><msubsup><mi>u</mi><mi>k</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>g</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><munder><mo>âˆ‘</mo><mrow><mi>k</mi><mo>âˆ‰</mo><mi>p</mi><mo stretchy="false" form="prefix">[</mo><mi>i</mi><mo stretchy="false" form="postfix">]</mo></mrow></munder><msubsup><mi>w</mi><mrow><mi>i</mi><mi>k</mi></mrow><mrow><mo stretchy="false" form="prefix">(</mo><mi>o</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>ğ›ƒ</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>o</mi><mo stretchy="false" form="postfix">)</mo></mrow></msup><mo>â‹…</mo><msubsup><mi>ğ±</mi><mrow><mi>i</mi><mi>k</mi></mrow><mrow><mo stretchy="false" form="prefix">(</mo><mi>o</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><mo>+</mo><msubsup><mi>u</mi><mi>k</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>o</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\begin{equation}
\theta_i^{(p)} = \sum_{k \in p[i]} w_{ik}^{(g)} \left( \boldsymbol{\beta}^{(g)} \cdot \mathbf{x}_{ik}^{(g)} + u_k^{(g)} \right) + \sum_{k \notin p[i]} w_{ik}^{(o)} \left( \boldsymbol{\beta}^{(o)} \cdot \mathbf{x}_{ik}^{(o)} + u_k^{(o)} \right)
\end{equation}</annotation></semantics></math></p>
<p>where superscripts
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><mi>g</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(g)</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><mi>o</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(o)</annotation></semantics></math>
denote member and non-member effects, respectively. This allows both
groups to have different structural effects and different aggregation
mechanisms.</p>
</div>
<div class="section level3">
<h3 id="generalized-outcomes">Generalized Outcomes<a class="anchor" aria-label="anchor" href="#generalized-outcomes"></a>
</h3>
<p>The model structure extends to non-Gaussian outcomes via generalized
linear and survival models:</p>
<p><strong>Binomial (Logistic Regression):</strong></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">logit</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>P</mi><mo stretchy="false" form="prefix">(</mo><msubsup><mi>y</mi><mi>i</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>g</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><mo>=</mo><mn>1</mn><mo stretchy="false" form="postfix">)</mo><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msubsup><mi>Î¸</mi><mi>i</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>g</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><mo>+</mo><msubsup><mi>Î¸</mi><mrow><mi>j</mi><mo stretchy="false" form="prefix">[</mo><mi>i</mi><mo stretchy="false" form="postfix">]</mo></mrow><mrow><mo stretchy="false" form="prefix">(</mo><mi>c</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><mo>+</mo><msubsup><mi>Î¸</mi><mi>i</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup></mrow><annotation encoding="application/x-tex">\begin{equation}
\text{logit}\left(P(y_i^{(g)} = 1)\right) = \theta_i^{(g)} + \theta_{j[i]}^{(c)} + \theta_i^{(p)}
\end{equation}</annotation></semantics></math></p>
<p><strong>Weibull Survival Model:</strong></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi mathvariant="normal">log</mi><mo>â¡</mo></mrow><mo stretchy="false" form="prefix">(</mo><msub><mi>t</mi><mi>i</mi></msub><mo stretchy="false" form="postfix">)</mo><mo>=</mo><msubsup><mi>Î¸</mi><mi>i</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>g</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><mo>+</mo><msubsup><mi>Î¸</mi><mrow><mi>j</mi><mo stretchy="false" form="prefix">[</mo><mi>i</mi><mo stretchy="false" form="postfix">]</mo></mrow><mrow><mo stretchy="false" form="prefix">(</mo><mi>c</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><mo>+</mo><msubsup><mi>Î¸</mi><mi>i</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><mo>+</mo><mi>Ïƒ</mi><msub><mi>Ïµ</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\begin{equation}
\log(t_i) = \theta_i^{(g)} + \theta_{j[i]}^{(c)} + \theta_i^{(p)} + \sigma \epsilon_i
\end{equation}</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mi>i</mi></msub><annotation encoding="application/x-tex">t_i</annotation></semantics></math>
is survival time,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Ïµ</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\epsilon_i</annotation></semantics></math>
follows an extreme value distribution, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Ïƒ</mi><annotation encoding="application/x-tex">\sigma</annotation></semantics></math>
is the scale parameter related to the Weibull shape parameter.</p>
<p><strong>Cox Proportional Hazards Model:</strong></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mo stretchy="false" form="prefix">(</mo><msub><mi>t</mi><mi>i</mi></msub><mo stretchy="false" form="postfix">)</mo><mo>=</mo><msub><mi>h</mi><mn>0</mn></msub><mo stretchy="false" form="prefix">(</mo><mi>t</mi><mo stretchy="false" form="postfix">)</mo><mrow><mi mathvariant="normal">exp</mi><mo>â¡</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>Î¸</mi><mi>i</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>g</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><mo>+</mo><msubsup><mi>Î¸</mi><mrow><mi>j</mi><mo stretchy="false" form="prefix">[</mo><mi>i</mi><mo stretchy="false" form="postfix">]</mo></mrow><mrow><mo stretchy="false" form="prefix">(</mo><mi>c</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><mo>+</mo><msubsup><mi>Î¸</mi><mi>i</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\begin{equation}
h(t_i) = h_0(t) \exp\left(\theta_i^{(g)} + \theta_{j[i]}^{(c)} + \theta_i^{(p)}\right)
\end{equation}</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mn>0</mn></msub><mo stretchy="false" form="prefix">(</mo><mi>t</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">h_0(t)</annotation></semantics></math>
is the baseline hazard function, estimated non-parametrically or as a
piecewise constant function.</p>
<p>All outcome types support the full multilevel and multiple-membership
structure, including parameterizable weight functions.</p>
</div>
</div>
<div class="section level2">
<h2 id="comparison-with-conventional-mmmm">Comparison with Conventional MMMM<a class="anchor" aria-label="anchor" href="#comparison-with-conventional-mmmm"></a>
</h2>
<p>The <strong>conventional MMMM</strong> (as implemented in
<code>brms</code> or <code>MLwiN</code>) is a special case:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>y</mi><mi>i</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>g</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><mo>=</mo><msup><mi>ğ›ƒ</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>g</mi><mo stretchy="false" form="postfix">)</mo></mrow></msup><mo>â‹…</mo><msubsup><mi>ğ±</mi><mi>i</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>g</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><mo>+</mo><msup><mi>ğ›ƒ</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo stretchy="false" form="postfix">)</mo></mrow></msup><mo>â‹…</mo><msubsup><mover><mi>ğ±</mi><mo accent="true">â€¾</mo></mover><mi>i</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><mo>+</mo><munder><mo>âˆ‘</mo><mrow><mi>k</mi><mo>âˆˆ</mo><mi>p</mi><mo stretchy="false" form="prefix">[</mo><mi>i</mi><mo stretchy="false" form="postfix">]</mo></mrow></munder><msub><mi>w</mi><mrow><mi>i</mi><mi>k</mi></mrow></msub><msubsup><mi>u</mi><mi>k</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><mo>+</mo><msubsup><mi>u</mi><mi>i</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>g</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup></mrow><annotation encoding="application/x-tex">\begin{equation}
y_i^{(g)} = \boldsymbol{\beta}^{(g)} \cdot \mathbf{x}_i^{(g)} + \boldsymbol{\beta}^{(p)} \cdot \bar{\mathbf{x}}_{i}^{(p)} + \sum_{k \in p[i]} w_{ik} u_k^{(p)} + u_i^{(g)} \tag{Conventional MMMM}
\end{equation}</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mover><mi>ğ±</mi><mo accent="true">â€¾</mo></mover><mi>i</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><mo>=</mo><msub><mo>âˆ‘</mo><mi>k</mi></msub><msub><mi>w</mi><mrow><mi>i</mi><mi>k</mi></mrow></msub><msubsup><mi>ğ±</mi><mrow><mi>i</mi><mi>k</mi></mrow><mrow><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup></mrow><annotation encoding="application/x-tex">\bar{\mathbf{x}}_{i}^{(p)} = \sum_k w_{ik} \mathbf{x}_{ik}^{(p)}</annotation></semantics></math>
is pre-aggregated using <em>imposed</em> weights
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><mrow><mi>i</mi><mi>k</mi></mrow></msub><annotation encoding="application/x-tex">w_{ik}</annotation></semantics></math>.</p>
<p>The <strong>extended MMMM</strong> generalizes this by:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Aggregating both systematic and random components</strong>
within the model</li>
<li>
<strong>Endogenizing weights</strong> as functions of covariates
with estimable parameters</li>
<li>
<strong>Enabling multiple aggregation mechanisms</strong> via
multiple <code><a href="../reference/mm.html">mm()</a></code> blocks</li>
</ol>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>y</mi><mi>i</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>g</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><mo>=</mo><msup><mi>ğ›ƒ</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>g</mi><mo stretchy="false" form="postfix">)</mo></mrow></msup><mo>â‹…</mo><msubsup><mi>ğ±</mi><mi>i</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>g</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><mo>+</mo><munder><mo>âˆ‘</mo><mrow><mi>k</mi><mo>âˆˆ</mo><mi>p</mi><mo stretchy="false" form="prefix">[</mo><mi>i</mi><mo stretchy="false" form="postfix">]</mo></mrow></munder><msub><mi>w</mi><mrow><mi>i</mi><mi>k</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>ğ›ƒ</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo stretchy="false" form="postfix">)</mo></mrow></msup><mo>â‹…</mo><msubsup><mi>ğ±</mi><mrow><mi>i</mi><mi>k</mi></mrow><mrow><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><mo>+</mo><msubsup><mi>u</mi><mi>k</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msubsup><mi>u</mi><mi>i</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>g</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><mo>,</mo><mspace width="1.0em"></mspace><msub><mi>w</mi><mrow><mi>i</mi><mi>k</mi></mrow></msub><mo>=</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><msubsup><mi>ğ±</mi><mrow><mi>i</mi><mi>k</mi></mrow><mrow><mo stretchy="false" form="prefix">(</mo><mi>w</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><mo>,</mo><msub><mi>n</mi><mi>i</mi></msub><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">\begin{equation}
y_i^{(g)} = \boldsymbol{\beta}^{(g)} \cdot \mathbf{x}_i^{(g)} + \sum_{k \in p[i]} w_{ik} \left( \boldsymbol{\beta}^{(p)} \cdot \mathbf{x}_{ik}^{(p)} + u_k^{(p)} \right) + u_i^{(g)}, \quad w_{ik} = f(\mathbf{x}_{ik}^{(w)}, n_i) \tag{Extended MMMM}
\end{equation}</annotation></semantics></math></p>
</div>
<div class="section level2">
<h2 id="model-assumptions">Model Assumptions<a class="anchor" aria-label="anchor" href="#model-assumptions"></a>
</h2>
<p>The extended MMMM assumes:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Independence of random components</strong> across levels:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>u</mi><mi>i</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>g</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><mo>âŸ‚</mo><msubsup><mi>u</mi><mi>j</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>c</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><mo>âŸ‚</mo><msubsup><mi>u</mi><mi>k</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup></mrow><annotation encoding="application/x-tex">u_i^{(g)} \perp u_j^{(c)} \perp u_k^{(p)}</annotation></semantics></math>.
If violated, variance estimates may be biased. More complex covariance
structures can be accommodated if needed.</p></li>
<li><p><strong>Random effects are uncorrelated with covariates</strong>
(random effects assumption). Including within-cluster means of
covariates or using within-between specifications isolates
within-cluster effects, yielding identical point estimates to fixed
effect models.</p></li>
<li><p><strong>Correct functional form</strong> for weight function. The
logistic-type function in Equation (7) is flexible, but other forms can
be specified using the <code><a href="../reference/fn.html">fn()</a></code> syntax.</p></li>
<li><p><strong>Proper model specification:</strong> Misspecifying a
weight covariate as a structural covariate (or vice versa) yields null
effects for the misspecified variable while correctly identifying
properly specified ones, provided there is no omitted variable
bias.</p></li>
</ol>
</div>
<div class="section level2">
<h2 id="estimation">Estimation<a class="anchor" aria-label="anchor" href="#estimation"></a>
</h2>
<p>Model parameters are estimated using <strong>Bayesian Markov chain
Monte Carlo (MCMC)</strong> via JAGS because:</p>
<ol style="list-style-type: decimal">
<li>The likelihood has no closed-form solution due to the parameterized
weight function</li>
<li>Bayesian estimation captures uncertainty in variance estimates,
yielding credible intervals even when maximum likelihood methods report
zero variance</li>
<li>Weakly informative priors can be specified for all parameters to
regularize estimates in small samples</li>
</ol>
<p>The <code>bml</code> package provides a user-friendly interface to
JAGS with automated prior specification, convergence diagnostics, and
post-estimation tools.</p>
</div>
<div class="section level2">
<h2 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h2>
<p>The extended MMMM provides a flexible framework for analyzing group
outcomes when:</p>
<ul>
<li>Groups are composed of multiple members</li>
<li>Members participate in multiple groups</li>
<li>The aggregation of member-level effects to group-level outcomes is
theoretically uncertain</li>
</ul>
<p>By modeling rather than imposing aggregation weights, researchers can
test substantive hypotheses about micro-macro linkages, avoid
aggregation bias, and account for complex dependence structures in
multilevel data.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Benjamin Rosche.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
